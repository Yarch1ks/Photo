"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/process/route";
exports.ids = ["app/api/process/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mak_Desktop_PhotoSku_src_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/process/route.ts */ \"(rsc)/./src/app/api/process/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/process/route\",\n        pathname: \"/api/process\",\n        filename: \"route\",\n        bundlePath: \"app/api/process/route\"\n    },\n    resolvedPagePath: \"/Users/mak/Desktop/PhotoSku/src/app/api/process/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mak_Desktop_PhotoSku_src_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/process/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcHJvY2VzcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1hayUyRkRlc2t0b3AlMkZQaG90b1NrdSUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZtYWslMkZEZXNrdG9wJTJGUGhvdG9Ta3UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvP2Y2OGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL21hay9EZXNrdG9wL1Bob3RvU2t1L3NyYy9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Byb2Nlc3Mvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wcm9jZXNzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9wcm9jZXNzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL21hay9EZXNrdG9wL1Bob3RvU2t1L3NyYy9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcHJvY2Vzcy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/process/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/process/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_services_PhotoRoomService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/services/PhotoRoomService */ \"(rsc)/./src/lib/services/PhotoRoomService.ts\");\n\n\n\n\n// Ограничение на одновременные запросы к PhotoRoom\nconst MAX_CONCURRENT_REQUESTS = 3;\nlet activeRequests = 0;\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sku, files } = body;\n        if (!sku || !files || files.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"SKU and files are required\"\n            }, {\n                status: 400\n            });\n        }\n        const photoRoomService = new _lib_services_PhotoRoomService__WEBPACK_IMPORTED_MODULE_3__.PhotoRoomService();\n        const results = [];\n        // Фильтруем только изображения для обработки\n        const imageFiles = files.filter((file)=>file.type === \"image\");\n        const videoFiles = files.filter((file)=>file.type === \"video\");\n        // Считаем общее количество файлов для правильной нумерации\n        const totalFiles = imageFiles.length + videoFiles.length;\n        let fileCounter = 1;\n        // Сохраняем пути к оригинальным файлам для удаления после обработки\n        const originalFilesToDelete = [];\n        // Обрабатываем видео (просто пропускаем)\n        for (const videoFile of videoFiles){\n            const finalName = `${sku}_${String(fileCounter).padStart(3, \"0\")}.mp4`;\n            results.push({\n                id: videoFile.id,\n                originalName: videoFile.fileName,\n                finalName: finalName,\n                status: \"skipped\"\n            });\n            fileCounter++;\n        }\n        // Обрабатываем изображения с ограничением concurrent запросов\n        for(let i = 0; i < imageFiles.length; i += MAX_CONCURRENT_REQUESTS){\n            const batch = imageFiles.slice(i, i + MAX_CONCURRENT_REQUESTS);\n            // Ждем, если слишком много активных запросов\n            while(activeRequests >= MAX_CONCURRENT_REQUESTS){\n                await new Promise((resolve)=>setTimeout(resolve, 1000));\n            }\n            activeRequests++;\n            const batchPromises = batch.map(async (file)=>{\n                try {\n                    // Генерируем уникальное имя файла для этого конкретного файла\n                    const currentFileCounter = fileCounter++;\n                    // PhotoRoom всегда возвращает JPG формат\n                    const finalName = `${sku}_${String(currentFileCounter).padStart(3, \"0\")}.jpg`;\n                    // Читаем файл из правильной директории\n                    const uploadDir = process.env.RAILWAY_SERVICE_NAME ? \"/tmp/uploads\" : \"./uploads\";\n                    const filePath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(uploadDir, file.fileName);\n                    const fileBuffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile)(filePath);\n                    // Удаляем фон через PhotoRoom\n                    const processedBuffer = await photoRoomService.removeBackground(fileBuffer);\n                    // Сохраняем обработанный файл в ту же директорию\n                    const processedPath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(uploadDir, finalName);\n                    await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(processedPath, processedBuffer);\n                    console.log(`Processed file saved to: ${processedPath}`);\n                    // Добавляем оригинальный файл в список для удаления\n                    originalFilesToDelete.push(filePath);\n                    return {\n                        id: file.id,\n                        originalName: file.originalName,\n                        finalName: finalName,\n                        status: \"done\",\n                        processedPath\n                    };\n                } catch (error) {\n                    console.error(`Error processing file ${file.fileName}:`, error);\n                    // Генерируем уникальное имя файла для ошибки\n                    const currentFileCounter = fileCounter++;\n                    // В случае ошибки, оставляем оригинал и помечаем как ошибку\n                    const originalExtension = file.fileName.split(\".\").pop() || \"jpg\";\n                    const errorFinalName = `${sku}_${String(currentFileCounter).padStart(3, \"0\")}.${originalExtension}`;\n                    // В случае ошибки не удаляем оригинал\n                    return {\n                        id: file.id,\n                        originalName: file.originalName,\n                        finalName: errorFinalName,\n                        status: \"error\",\n                        error: error instanceof Error ? error.message : \"Unknown error\",\n                        processedPath: (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.env.RAILWAY_SERVICE_NAME ? \"/tmp/uploads\" : \"./uploads\", file.fileName)\n                    };\n                }\n            });\n            const batchResults = await Promise.all(batchPromises);\n            results.push(...batchResults);\n            activeRequests--;\n        }\n        // Сохраняем информацию о процессинге в отдельный файл для использования при скачивании\n        const uploadDir = process.env.RAILWAY_SERVICE_NAME ? \"/tmp/uploads\" : \"./uploads\";\n        const processInfoPath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(uploadDir, `${sku}-process-info.json`);\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(processInfoPath, JSON.stringify(results, null, 2));\n        // Удаляем оригинальные файлы после успешной обработки\n        for (const filePath of originalFilesToDelete){\n            try {\n                await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.unlink)(filePath);\n                console.log(`Deleted original file: ${filePath}`);\n            } catch (error) {\n                console.error(`Error deleting file ${filePath}:`, error);\n            }\n        }\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            results,\n            sku\n        });\n    } catch (error) {\n        console.error(\"Process error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVNBLENBQUM0RCxpQkFBaUJDLEtBQUtDLFNBQVMsQ0FBQy9DLFNBQVMsTUFBTTtRQUUvRCxzREFBc0Q7UUFDdEQsS0FBSyxNQUFNOEIsWUFBWXRCLHNCQUF1QjtZQUM1QyxJQUFJO2dCQUNGLE1BQU14QixtREFBTUEsQ0FBQzhDO2dCQUNiSyxRQUFRQyxHQUFHLENBQUMsQ0FBQyx1QkFBdUIsRUFBRU4sU0FBUyxDQUFDO1lBQ2xELEVBQUUsT0FBT2pDLE9BQU87Z0JBQ2RzQyxRQUFRdEMsS0FBSyxDQUFDLENBQUMsb0JBQW9CLEVBQUVpQyxTQUFTLENBQUMsQ0FBQyxFQUFFakM7WUFDcEQ7UUFDRjtRQUVBLE9BQU9mLGtGQUFZQSxDQUFDVyxJQUFJLENBQUM7WUFDdkJ1RCxTQUFTO1lBQ1RoRDtZQUNBTjtRQUNGO0lBRUYsRUFBRSxPQUFPRyxPQUFPO1FBQ2RzQyxRQUFRdEMsS0FBSyxDQUFDLGtCQUFrQkE7UUFDaEMsT0FBT2Ysa0ZBQVlBLENBQUNXLElBQUksQ0FDdEI7WUFBRUksT0FBTztRQUF3QixHQUNqQztZQUFFQyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvLi9zcmMvYXBwL2FwaS9wcm9jZXNzL3JvdXRlLnRzPzZhZjIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJ1xuaW1wb3J0IHsgcmVhZEZpbGUsIHVubGluaywgd3JpdGVGaWxlLCBvcGVuIH0gZnJvbSAnZnMvcHJvbWlzZXMnXG5pbXBvcnQgeyBqb2luIH0gZnJvbSAncGF0aCdcbmltcG9ydCB7IFBob3RvUm9vbVNlcnZpY2UgfSBmcm9tICdAL2xpYi9zZXJ2aWNlcy9QaG90b1Jvb21TZXJ2aWNlJ1xuXG5pbnRlcmZhY2UgUHJvY2Vzc1JlcXVlc3Qge1xuICBza3U6IHN0cmluZ1xuICBmaWxlczogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmdcbiAgICBmaWxlTmFtZTogc3RyaW5nXG4gICAgZmlsZVBhdGg6IHN0cmluZ1xuICAgIHR5cGU6IHN0cmluZ1xuICAgIG9yaWdpbmFsTmFtZTogc3RyaW5nXG4gIH0+XG59XG5cbmludGVyZmFjZSBQcm9jZXNzUmVzcG9uc2Uge1xuICBzdWNjZXNzOiBib29sZWFuXG4gIHJlc3VsdHM6IEFycmF5PHtcbiAgICBpZDogc3RyaW5nXG4gICAgb3JpZ2luYWxOYW1lOiBzdHJpbmdcbiAgICBmaW5hbE5hbWU6IHN0cmluZ1xuICAgIHN0YXR1czogJ2RvbmUnIHwgJ2Vycm9yJyB8ICdza2lwcGVkJ1xuICAgIGVycm9yPzogc3RyaW5nXG4gICAgcHJvY2Vzc2VkUGF0aD86IHN0cmluZ1xuICB9PlxufVxuXG4vLyDQntCz0YDQsNC90LjRh9C10L3QuNC1INC90LAg0L7QtNC90L7QstGA0LXQvNC10L3QvdGL0LUg0LfQsNC/0YDQvtGB0Ysg0LogUGhvdG9Sb29tXG5jb25zdCBNQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUyA9IDNcbmxldCBhY3RpdmVSZXF1ZXN0cyA9IDBcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCkgYXMgUHJvY2Vzc1JlcXVlc3RcbiAgICBjb25zdCB7IHNrdSwgZmlsZXMgfSA9IGJvZHlcblxuICAgIGlmICghc2t1IHx8ICFmaWxlcyB8fCBmaWxlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBlcnJvcjogJ1NLVSBhbmQgZmlsZXMgYXJlIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgIClcbiAgICB9XG5cbiAgICBjb25zdCBwaG90b1Jvb21TZXJ2aWNlID0gbmV3IFBob3RvUm9vbVNlcnZpY2UoKVxuICAgIGNvbnN0IHJlc3VsdHM6IFByb2Nlc3NSZXNwb25zZVsncmVzdWx0cyddID0gW11cblxuICAgIC8vINCk0LjQu9GM0YLRgNGD0LXQvCDRgtC+0LvRjNC60L4g0LjQt9C+0LHRgNCw0LbQtdC90LjRjyDQtNC70Y8g0L7QsdGA0LDQsdC+0YLQutC4XG4gICAgY29uc3QgaW1hZ2VGaWxlcyA9IGZpbGVzLmZpbHRlcihmaWxlID0+IGZpbGUudHlwZSA9PT0gJ2ltYWdlJylcbiAgICBjb25zdCB2aWRlb0ZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS50eXBlID09PSAndmlkZW8nKVxuXG4gICAgLy8g0KHRh9C40YLQsNC10Lwg0L7QsdGJ0LXQtSDQutC+0LvQuNGH0LXRgdGC0LLQviDRhNCw0LnQu9C+0LIg0LTQu9GPINC/0YDQsNCy0LjQu9GM0L3QvtC5INC90YPQvNC10YDQsNGG0LjQuFxuICAgIGNvbnN0IHRvdGFsRmlsZXMgPSBpbWFnZUZpbGVzLmxlbmd0aCArIHZpZGVvRmlsZXMubGVuZ3RoXG4gICAgbGV0IGZpbGVDb3VudGVyID0gMVxuICAgIFxuICAgIC8vINCh0L7RhdGA0LDQvdGP0LXQvCDQv9GD0YLQuCDQuiDQvtGA0LjQs9C40L3QsNC70YzQvdGL0Lwg0YTQsNC50LvQsNC8INC00LvRjyDRg9C00LDQu9C10L3QuNGPINC/0L7RgdC70LUg0L7QsdGA0LDQsdC+0YLQutC4XG4gICAgY29uc3Qgb3JpZ2luYWxGaWxlc1RvRGVsZXRlOiBzdHJpbmdbXSA9IFtdXG5cbiAgICAvLyDQntCx0YDQsNCx0LDRgtGL0LLQsNC10Lwg0LLQuNC00LXQviAo0L/RgNC+0YHRgtC+INC/0YDQvtC/0YPRgdC60LDQtdC8KVxuICAgIGZvciAoY29uc3QgdmlkZW9GaWxlIG9mIHZpZGVvRmlsZXMpIHtcbiAgICAgIGNvbnN0IGZpbmFsTmFtZSA9IGAke3NrdX1fJHtTdHJpbmcoZmlsZUNvdW50ZXIpLnBhZFN0YXJ0KDMsICcwJyl9Lm1wNGBcbiAgICAgIHJlc3VsdHMucHVzaCh7XG4gICAgICAgIGlkOiB2aWRlb0ZpbGUuaWQsXG4gICAgICAgIG9yaWdpbmFsTmFtZTogdmlkZW9GaWxlLmZpbGVOYW1lLFxuICAgICAgICBmaW5hbE5hbWU6IGZpbmFsTmFtZSxcbiAgICAgICAgc3RhdHVzOiAnc2tpcHBlZCdcbiAgICAgIH0pXG4gICAgICBmaWxlQ291bnRlcisrXG4gICAgfVxuXG4gICAgLy8g0J7QsdGA0LDQsdCw0YLRi9Cy0LDQtdC8INC40LfQvtCx0YDQsNC20LXQvdC40Y8g0YEg0L7Qs9GA0LDQvdC40YfQtdC90LjQtdC8IGNvbmN1cnJlbnQg0LfQsNC/0YDQvtGB0L7QslxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW1hZ2VGaWxlcy5sZW5ndGg7IGkgKz0gTUFYX0NPTkNVUlJFTlRfUkVRVUVTVFMpIHtcbiAgICAgIGNvbnN0IGJhdGNoID0gaW1hZ2VGaWxlcy5zbGljZShpLCBpICsgTUFYX0NPTkNVUlJFTlRfUkVRVUVTVFMpXG4gICAgICBcbiAgICAgIC8vINCW0LTQtdC8LCDQtdGB0LvQuCDRgdC70LjRiNC60L7QvCDQvNC90L7Qs9C+INCw0LrRgtC40LLQvdGL0YUg0LfQsNC/0YDQvtGB0L7QslxuICAgICAgd2hpbGUgKGFjdGl2ZVJlcXVlc3RzID49IE1BWF9DT05DVVJSRU5UX1JFUVVFU1RTKSB7XG4gICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCAxMDAwKSlcbiAgICAgIH1cblxuICAgICAgYWN0aXZlUmVxdWVzdHMrK1xuXG4gICAgICBjb25zdCBiYXRjaFByb21pc2VzID0gYmF0Y2gubWFwKGFzeW5jIChmaWxlKSA9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgLy8g0JPQtdC90LXRgNC40YDRg9C10Lwg0YPQvdC40LrQsNC70YzQvdC+0LUg0LjQvNGPINGE0LDQudC70LAg0LTQu9GPINGN0YLQvtCz0L4g0LrQvtC90LrRgNC10YLQvdC+0LPQviDRhNCw0LnQu9CwXG4gICAgICAgICAgY29uc3QgY3VycmVudEZpbGVDb3VudGVyID0gZmlsZUNvdW50ZXIrK1xuICAgICAgICAgIFxuICAgICAgICAgIC8vIFBob3RvUm9vbSDQstGB0LXQs9C00LAg0LLQvtC30LLRgNCw0YnQsNC10YIgSlBHINGE0L7RgNC80LDRglxuICAgICAgICAgIGNvbnN0IGZpbmFsTmFtZSA9IGAke3NrdX1fJHtTdHJpbmcoY3VycmVudEZpbGVDb3VudGVyKS5wYWRTdGFydCgzLCAnMCcpfS5qcGdgXG4gICAgICAgICAgXG4gICAgICAgICAgLy8g0KfQuNGC0LDQtdC8INGE0LDQudC7INC40Lcg0L/RgNCw0LLQuNC70YzQvdC+0Lkg0LTQuNGA0LXQutGC0L7RgNC40LhcbiAgICAgICAgICBjb25zdCB1cGxvYWREaXIgPSBwcm9jZXNzLmVudi5SQUlMV0FZX1NFUlZJQ0VfTkFNRSA/ICcvdG1wL3VwbG9hZHMnIDogJy4vdXBsb2FkcydcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGpvaW4odXBsb2FkRGlyLCBmaWxlLmZpbGVOYW1lKVxuICAgICAgICAgIGNvbnN0IGZpbGVCdWZmZXIgPSBhd2FpdCByZWFkRmlsZShmaWxlUGF0aClcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQo9C00LDQu9GP0LXQvCDRhNC+0L0g0YfQtdGA0LXQtyBQaG90b1Jvb21cbiAgICAgICAgICBjb25zdCBwcm9jZXNzZWRCdWZmZXIgPSBhd2FpdCBwaG90b1Jvb21TZXJ2aWNlLnJlbW92ZUJhY2tncm91bmQoZmlsZUJ1ZmZlcilcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQodC+0YXRgNCw0L3Rj9C10Lwg0L7QsdGA0LDQsdC+0YLQsNC90L3Ri9C5INGE0LDQudC7INCyINGC0YMg0LbQtSDQtNC40YDQtdC60YLQvtGA0LjRjlxuICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZFBhdGggPSBqb2luKHVwbG9hZERpciwgZmluYWxOYW1lKVxuICAgICAgICAgIGF3YWl0IHdyaXRlRmlsZShwcm9jZXNzZWRQYXRoLCBwcm9jZXNzZWRCdWZmZXIpXG4gICAgICAgICAgXG4gICAgICAgICAgY29uc29sZS5sb2coYFByb2Nlc3NlZCBmaWxlIHNhdmVkIHRvOiAke3Byb2Nlc3NlZFBhdGh9YClcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0L7RgNC40LPQuNC90LDQu9GM0L3Ri9C5INGE0LDQudC7INCyINGB0L/QuNGB0L7QuiDQtNC70Y8g0YPQtNCw0LvQtdC90LjRj1xuICAgICAgICAgIG9yaWdpbmFsRmlsZXNUb0RlbGV0ZS5wdXNoKGZpbGVQYXRoKVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogZmlsZS5pZCxcbiAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogZmlsZS5vcmlnaW5hbE5hbWUsIC8vIDwtLSDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvtGA0LjQs9C40L3QsNC70YzQvdC+0LUg0LjQvNGPINGE0LDQudC70LBcbiAgICAgICAgICAgIGZpbmFsTmFtZTogZmluYWxOYW1lLFxuICAgICAgICAgICAgc3RhdHVzOiAnZG9uZScgYXMgY29uc3QsXG4gICAgICAgICAgICBwcm9jZXNzZWRQYXRoXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGUuZmlsZU5hbWV9OmAsIGVycm9yKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCT0LXQvdC10YDQuNGA0YPQtdC8INGD0L3QuNC60LDQu9GM0L3QvtC1INC40LzRjyDRhNCw0LnQu9CwINC00LvRjyDQvtGI0LjQsdC60LhcbiAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNvdW50ZXIgPSBmaWxlQ291bnRlcisrXG4gICAgICAgICAgXG4gICAgICAgICAgLy8g0JIg0YHQu9GD0YfQsNC1INC+0YjQuNCx0LrQuCwg0L7RgdGC0LDQstC70Y/QtdC8INC+0YDQuNCz0LjQvdCw0Lsg0Lgg0L/QvtC80LXRh9Cw0LXQvCDQutCw0Log0L7RiNC40LHQutGDXG4gICAgICAgICAgY29uc3Qgb3JpZ2luYWxFeHRlbnNpb24gPSBmaWxlLmZpbGVOYW1lLnNwbGl0KCcuJykucG9wKCkgfHwgJ2pwZydcbiAgICAgICAgICBjb25zdCBlcnJvckZpbmFsTmFtZSA9IGAke3NrdX1fJHtTdHJpbmcoY3VycmVudEZpbGVDb3VudGVyKS5wYWRTdGFydCgzLCAnMCcpfS4ke29yaWdpbmFsRXh0ZW5zaW9ufWBcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQkiDRgdC70YPRh9Cw0LUg0L7RiNC40LHQutC4INC90LUg0YPQtNCw0LvRj9C10Lwg0L7RgNC40LPQuNC90LDQu1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogZmlsZS5pZCxcbiAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogZmlsZS5vcmlnaW5hbE5hbWUsXG4gICAgICAgICAgICBmaW5hbE5hbWU6IGVycm9yRmluYWxOYW1lLFxuICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InIGFzIGNvbnN0LFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgcHJvY2Vzc2VkUGF0aDogam9pbihwcm9jZXNzLmVudi5SQUlMV0FZX1NFUlZJQ0VfTkFNRSA/ICcvdG1wL3VwbG9hZHMnIDogJy4vdXBsb2FkcycsIGZpbGUuZmlsZU5hbWUpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KVxuXG4gICAgICBjb25zdCBiYXRjaFJlc3VsdHMgPSBhd2FpdCBQcm9taXNlLmFsbChiYXRjaFByb21pc2VzKVxuICAgICAgcmVzdWx0cy5wdXNoKC4uLmJhdGNoUmVzdWx0cylcbiAgICAgIFxuICAgICAgYWN0aXZlUmVxdWVzdHMtLVxuICAgIH1cblxuICAgIC8vINCh0L7RhdGA0LDQvdGP0LXQvCDQuNC90YTQvtGA0LzQsNGG0LjRjiDQviDQv9GA0L7RhtC10YHRgdC40L3Qs9C1INCyINC+0YLQtNC10LvRjNC90YvQuSDRhNCw0LnQuyDQtNC70Y8g0LjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40Y8g0L/RgNC4INGB0LrQsNGH0LjQstCw0L3QuNC4XG4gICAgY29uc3QgdXBsb2FkRGlyID0gcHJvY2Vzcy5lbnYuUkFJTFdBWV9TRVJWSUNFX05BTUUgPyAnL3RtcC91cGxvYWRzJyA6ICcuL3VwbG9hZHMnXG4gICAgY29uc3QgcHJvY2Vzc0luZm9QYXRoID0gam9pbih1cGxvYWREaXIsIGAke3NrdX0tcHJvY2Vzcy1pbmZvLmpzb25gKVxuICAgIGF3YWl0IHdyaXRlRmlsZShwcm9jZXNzSW5mb1BhdGgsIEpTT04uc3RyaW5naWZ5KHJlc3VsdHMsIG51bGwsIDIpKVxuICAgIFxuICAgIC8vINCj0LTQsNC70Y/QtdC8INC+0YDQuNCz0LjQvdCw0LvRjNC90YvQtSDRhNCw0LnQu9GLINC/0L7RgdC70LUg0YPRgdC/0LXRiNC90L7QuSDQvtCx0YDQsNCx0L7RgtC60LhcbiAgICBmb3IgKGNvbnN0IGZpbGVQYXRoIG9mIG9yaWdpbmFsRmlsZXNUb0RlbGV0ZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdW5saW5rKGZpbGVQYXRoKVxuICAgICAgICBjb25zb2xlLmxvZyhgRGVsZXRlZCBvcmlnaW5hbCBmaWxlOiAke2ZpbGVQYXRofWApXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBkZWxldGluZyBmaWxlICR7ZmlsZVBhdGh9OmAsIGVycm9yKVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgcmVzdWx0cyxcbiAgICAgIHNrdVxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdQcm9jZXNzIGVycm9yOicsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApXG4gIH1cbn0iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicmVhZEZpbGUiLCJ1bmxpbmsiLCJ3cml0ZUZpbGUiLCJqb2luIiwiUGhvdG9Sb29tU2VydmljZSIsIk1BWF9DT05DVVJSRU5UX1JFUVVFU1RTIiwiYWN0aXZlUmVxdWVzdHMiLCJQT1NUIiwicmVxdWVzdCIsImJvZHkiLCJqc29uIiwic2t1IiwiZmlsZXMiLCJsZW5ndGgiLCJlcnJvciIsInN0YXR1cyIsInBob3RvUm9vbVNlcnZpY2UiLCJyZXN1bHRzIiwiaW1hZ2VGaWxlcyIsImZpbHRlciIsImZpbGUiLCJ0eXBlIiwidmlkZW9GaWxlcyIsInRvdGFsRmlsZXMiLCJmaWxlQ291bnRlciIsIm9yaWdpbmFsRmlsZXNUb0RlbGV0ZSIsInZpZGVvRmlsZSIsImZpbmFsTmFtZSIsIlN0cmluZyIsInBhZFN0YXJ0IiwicHVzaCIsImlkIiwib3JpZ2luYWxOYW1lIiwiZmlsZU5hbWUiLCJpIiwiYmF0Y2giLCJzbGljZSIsIlByb21pc2UiLCJyZXNvbHZlIiwic2V0VGltZW91dCIsImJhdGNoUHJvbWlzZXMiLCJtYXAiLCJjdXJyZW50RmlsZUNvdW50ZXIiLCJ1cGxvYWREaXIiLCJwcm9jZXNzIiwiZW52IiwiUkFJTFdBWV9TRVJWSUNFX05BTUUiLCJmaWxlUGF0aCIsImZpbGVCdWZmZXIiLCJwcm9jZXNzZWRCdWZmZXIiLCJyZW1vdmVCYWNrZ3JvdW5kIiwicHJvY2Vzc2VkUGF0aCIsImNvbnNvbGUiLCJsb2ciLCJvcmlnaW5hbEV4dGVuc2lvbiIsInNwbGl0IiwicG9wIiwiZXJyb3JGaW5hbE5hbWUiLCJFcnJvciIsIm1lc3NhZ2UiLCJiYXRjaFJlc3VsdHMiLCJhbGwiLCJwcm9jZXNzSW5mb1BhdGgiLCJKU09OIiwic3RyaW5naWZ5Iiwic3VjY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/process/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALLOWED_IMAGE_TYPES: () => (/* binding */ ALLOWED_IMAGE_TYPES),\n/* harmony export */   ALLOWED_VIDEO_TYPES: () => (/* binding */ ALLOWED_VIDEO_TYPES),\n/* harmony export */   MAX_CONCURRENT_PHOTOROOM_REQUESTS: () => (/* binding */ MAX_CONCURRENT_PHOTOROOM_REQUESTS),\n/* harmony export */   MAX_FILE_SIZE: () => (/* binding */ MAX_FILE_SIZE),\n/* harmony export */   PHOTOROOM_MAX_RETRIES: () => (/* binding */ PHOTOROOM_MAX_RETRIES),\n/* harmony export */   PHOTOROOM_RETRY_DELAY: () => (/* binding */ PHOTOROOM_RETRY_DELAY),\n/* harmony export */   PHOTOROOM_TOKEN: () => (/* binding */ PHOTOROOM_TOKEN),\n/* harmony export */   QUALITY_SETTINGS: () => (/* binding */ QUALITY_SETTINGS),\n/* harmony export */   SUPPORTED_FORMATS: () => (/* binding */ SUPPORTED_FORMATS)\n/* harmony export */ });\nconst PHOTOROOM_TOKEN = process.env.PHOTOROOM_TOKEN || \"\";\nconst MAX_FILE_SIZE = 25 * 1024 * 1024 // 25MB\n;\nconst ALLOWED_IMAGE_TYPES = [\n    \"image/jpeg\",\n    \"image/jpg\",\n    \"image/png\",\n    \"image/heic\"\n];\nconst ALLOWED_VIDEO_TYPES = [\n    \"video/mp4\",\n    \"video/quicktime\"\n];\nconst MAX_CONCURRENT_PHOTOROOM_REQUESTS = 3;\nconst PHOTOROOM_RETRY_DELAY = 1000 // 1 second\n;\nconst PHOTOROOM_MAX_RETRIES = 3;\nconst SUPPORTED_FORMATS = {\n    images: [\n        \"jpg\",\n        \"jpeg\",\n        \"png\",\n        \"heic\"\n    ],\n    videos: [\n        \"mp4\",\n        \"mov\"\n    ]\n};\nconst QUALITY_SETTINGS = {\n    image: 0.92,\n    zip: 6 // compression level for ZIP\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBTyxNQUFNQSxrQkFBa0JDLFFBQVFDLEdBQUcsQ0FBQ0YsZUFBZSxJQUFJLEdBQUU7QUFFekQsTUFBTUcsZ0JBQWdCLEtBQUssT0FBTyxLQUFLLE9BQU87Q0FBUjtBQUN0QyxNQUFNQyxzQkFBc0I7SUFDakM7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUNNLE1BQU1DLHNCQUFzQjtJQUNqQztJQUNBO0NBQ0Q7QUFFTSxNQUFNQyxvQ0FBb0MsRUFBQztBQUMzQyxNQUFNQyx3QkFBd0IsS0FBSyxXQUFXO0NBQVo7QUFDbEMsTUFBTUMsd0JBQXdCLEVBQUM7QUFFL0IsTUFBTUMsb0JBQW9CO0lBQy9CQyxRQUFRO1FBQUM7UUFBTztRQUFRO1FBQU87S0FBTztJQUN0Q0MsUUFBUTtRQUFDO1FBQU87S0FBTTtBQUN4QixFQUFDO0FBRU0sTUFBTUMsbUJBQW1CO0lBQzlCQyxPQUFPO0lBQ1BDLEtBQUssRUFBRSw0QkFBNEI7QUFDckMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvLi9zcmMvbGliL2NvbmZpZy50cz9hM2VmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBQSE9UT1JPT01fVE9LRU4gPSBwcm9jZXNzLmVudi5QSE9UT1JPT01fVE9LRU4gfHwgJydcblxuZXhwb3J0IGNvbnN0IE1BWF9GSUxFX1NJWkUgPSAyNSAqIDEwMjQgKiAxMDI0IC8vIDI1TUJcbmV4cG9ydCBjb25zdCBBTExPV0VEX0lNQUdFX1RZUEVTID0gW1xuICAnaW1hZ2UvanBlZycsXG4gICdpbWFnZS9qcGcnLCBcbiAgJ2ltYWdlL3BuZycsXG4gICdpbWFnZS9oZWljJ1xuXVxuZXhwb3J0IGNvbnN0IEFMTE9XRURfVklERU9fVFlQRVMgPSBbXG4gICd2aWRlby9tcDQnLFxuICAndmlkZW8vcXVpY2t0aW1lJ1xuXVxuXG5leHBvcnQgY29uc3QgTUFYX0NPTkNVUlJFTlRfUEhPVE9ST09NX1JFUVVFU1RTID0gM1xuZXhwb3J0IGNvbnN0IFBIT1RPUk9PTV9SRVRSWV9ERUxBWSA9IDEwMDAgLy8gMSBzZWNvbmRcbmV4cG9ydCBjb25zdCBQSE9UT1JPT01fTUFYX1JFVFJJRVMgPSAzXG5cbmV4cG9ydCBjb25zdCBTVVBQT1JURURfRk9STUFUUyA9IHtcbiAgaW1hZ2VzOiBbJ2pwZycsICdqcGVnJywgJ3BuZycsICdoZWljJ10sXG4gIHZpZGVvczogWydtcDQnLCAnbW92J11cbn1cblxuZXhwb3J0IGNvbnN0IFFVQUxJVFlfU0VUVElOR1MgPSB7XG4gIGltYWdlOiAwLjkyLCAvLyA5MiUgcXVhbGl0eSBmb3IgY29udmVydGVkIGltYWdlc1xuICB6aXA6IDYgLy8gY29tcHJlc3Npb24gbGV2ZWwgZm9yIFpJUFxufSJdLCJuYW1lcyI6WyJQSE9UT1JPT01fVE9LRU4iLCJwcm9jZXNzIiwiZW52IiwiTUFYX0ZJTEVfU0laRSIsIkFMTE9XRURfSU1BR0VfVFlQRVMiLCJBTExPV0VEX1ZJREVPX1RZUEVTIiwiTUFYX0NPTkNVUlJFTlRfUEhPVE9ST09NX1JFUVVFU1RTIiwiUEhPVE9ST09NX1JFVFJZX0RFTEFZIiwiUEhPVE9ST09NX01BWF9SRVRSSUVTIiwiU1VQUE9SVEVEX0ZPUk1BVFMiLCJpbWFnZXMiLCJ2aWRlb3MiLCJRVUFMSVRZX1NFVFRJTkdTIiwiaW1hZ2UiLCJ6aXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/PhotoRoomService.ts":
/*!**********************************************!*\
  !*** ./src/lib/services/PhotoRoomService.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PhotoRoomService: () => (/* binding */ PhotoRoomService)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\nclass PhotoRoomService {\n    constructor(){\n        this.baseUrl = \"https://image-api.photoroom.com/v2/edit\";\n        this.maxRetries = 3;\n        this.retryDelay = 1000 // 1 second\n        ;\n        this.token = _lib_config__WEBPACK_IMPORTED_MODULE_0__.PHOTOROOM_TOKEN;\n        if (!this.token) {\n            throw new Error(\"PHOTOROOM_TOKEN is required\");\n        }\n    }\n    /**\n   * Удаляет фон изображения через PhotoRoom API\n   * @param imageBuffer Buffer с изображением\n   * @returns Promise<Buffer> с обработанным изображением\n   */ async removeBackground(imageBuffer) {\n        const formData = new FormData();\n        // Добавляем изображение как binary data\n        const blob = new Blob([\n            new Uint8Array(imageBuffer)\n        ], {\n            type: \"image/jpeg\"\n        });\n        formData.append(\"imageFile\", blob, \"image.jpg\");\n        // Параметры для удаления фона и обработки\n        formData.append(\"background.color\", \"FFFFFF\");\n        formData.append(\"outputSize\", \"2000x2000\");\n        formData.append(\"position.gravity\", \"center\");\n        formData.append(\"padding\", \"0.14\");\n        formData.append(\"export.format\", \"jpg\");\n        let lastError = null;\n        // Экспоненциальная задержка с ретраями\n        for(let attempt = 1; attempt <= this.maxRetries; attempt++){\n            try {\n                const response = await fetch(this.baseUrl, {\n                    method: \"POST\",\n                    headers: {\n                        \"Accept\": \"image/png, application/json\",\n                        \"x-api-key\": this.token\n                    },\n                    body: formData\n                });\n                if (!response.ok) {\n                    const errorData = await response.json().catch(()=>({}));\n                    // Обработка специфичных ошибок PhotoRoom\n                    if (response.status === 429) {\n                        throw new Error(\"Too many requests to PhotoRoom API\");\n                    } else if (response.status === 401) {\n                        throw new Error(\"Invalid PhotoRoom API token\");\n                    } else if (response.status >= 500) {\n                        throw new Error(`PhotoRoom server error: ${errorData.error || \"Unknown error\"}`);\n                    } else {\n                        throw new Error(`PhotoRoom API error: ${errorData.error || \"Unknown error\"}`);\n                    }\n                }\n                // PhotoRoom возвращает изображение напрямую, а не JSON\n                const imageBuffer = await response.arrayBuffer();\n                return Buffer.from(imageBuffer);\n            } catch (error) {\n                lastError = error instanceof Error ? error : new Error(String(error));\n                // Если это последняя попытка, выбрасываем ошибку\n                if (attempt === this.maxRetries) {\n                    break;\n                }\n                // Экспоненциальная задержка перед следующей попыткой\n                const delay = this.retryDelay * Math.pow(2, attempt - 1);\n                await new Promise((resolve)=>setTimeout(resolve, delay));\n            }\n        }\n        throw lastError || new Error(\"Failed to remove background after retries\");\n    }\n    /**\n   * Проверяет доступность PhotoRoom API\n   */ async checkHealth() {\n        try {\n            const response = await fetch(`${this.baseUrl}/health`, {\n                headers: {\n                    \"Authorization\": `Bearer ${this.token}`\n                }\n            });\n            return response.ok;\n        } catch  {\n            return false;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL1Bob3RvUm9vbVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEM7QUFVdkMsTUFBTUM7SUFNWEMsYUFBYzthQUpHQyxVQUFVO2FBQ1ZDLGFBQWE7YUFDYkMsYUFBYSxLQUFLLFdBQVc7O1FBRzVDLElBQUksQ0FBQ0MsS0FBSyxHQUFHTix3REFBZUE7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQ00sS0FBSyxFQUFFO1lBQ2YsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQTs7OztHQUlDLEdBQ0QsTUFBTUMsaUJBQWlCQyxXQUFtQixFQUFtQjtRQUMzRCxNQUFNQyxXQUFXLElBQUlDO1FBRXJCLHdDQUF3QztRQUN4QyxNQUFNQyxPQUFPLElBQUlDLEtBQUs7WUFBQyxJQUFJQyxXQUFXTDtTQUFhLEVBQUU7WUFBRU0sTUFBTTtRQUFhO1FBQzFFTCxTQUFTTSxNQUFNLENBQUMsYUFBYUosTUFBTTtRQUVuQywwQ0FBMEM7UUFDMUNGLFNBQVNNLE1BQU0sQ0FBQyxvQkFBb0I7UUFDcENOLFNBQVNNLE1BQU0sQ0FBQyxjQUFjO1FBQzlCTixTQUFTTSxNQUFNLENBQUMsb0JBQW9CO1FBQ3BDTixTQUFTTSxNQUFNLENBQUMsV0FBVztRQUMzQk4sU0FBU00sTUFBTSxDQUFDLGlCQUFpQjtRQUVqQyxJQUFJQyxZQUEwQjtRQUU5Qix1Q0FBdUM7UUFDdkMsSUFBSyxJQUFJQyxVQUFVLEdBQUdBLFdBQVcsSUFBSSxDQUFDZCxVQUFVLEVBQUVjLFVBQVc7WUFDM0QsSUFBSTtnQkFDRixNQUFNQyxXQUFXLE1BQU1DLE1BQU0sSUFBSSxDQUFDakIsT0FBTyxFQUFFO29CQUN6Q2tCLFFBQVE7b0JBQ1JDLFNBQVM7d0JBQ1AsVUFBVTt3QkFDVixhQUFhLElBQUksQ0FBQ2hCLEtBQUs7b0JBQ3pCO29CQUNBaUIsTUFBTWI7Z0JBQ1I7Z0JBRUEsSUFBSSxDQUFDUyxTQUFTSyxFQUFFLEVBQUU7b0JBQ2hCLE1BQU1DLFlBQVksTUFBTU4sU0FBU08sSUFBSSxHQUFHQyxLQUFLLENBQUMsSUFBTyxFQUFDO29CQUV0RCx5Q0FBeUM7b0JBQ3pDLElBQUlSLFNBQVNTLE1BQU0sS0FBSyxLQUFLO3dCQUMzQixNQUFNLElBQUlyQixNQUFNO29CQUNsQixPQUFPLElBQUlZLFNBQVNTLE1BQU0sS0FBSyxLQUFLO3dCQUNsQyxNQUFNLElBQUlyQixNQUFNO29CQUNsQixPQUFPLElBQUlZLFNBQVNTLE1BQU0sSUFBSSxLQUFLO3dCQUNqQyxNQUFNLElBQUlyQixNQUFNLENBQUMsd0JBQXdCLEVBQUVrQixVQUFVSSxLQUFLLElBQUksZ0JBQWdCLENBQUM7b0JBQ2pGLE9BQU87d0JBQ0wsTUFBTSxJQUFJdEIsTUFBTSxDQUFDLHFCQUFxQixFQUFFa0IsVUFBVUksS0FBSyxJQUFJLGdCQUFnQixDQUFDO29CQUM5RTtnQkFDRjtnQkFFQSx1REFBdUQ7Z0JBQ3ZELE1BQU1wQixjQUFjLE1BQU1VLFNBQVNXLFdBQVc7Z0JBQzlDLE9BQU9DLE9BQU9DLElBQUksQ0FBQ3ZCO1lBRXJCLEVBQUUsT0FBT29CLE9BQU87Z0JBQ2RaLFlBQVlZLGlCQUFpQnRCLFFBQVFzQixRQUFRLElBQUl0QixNQUFNMEIsT0FBT0o7Z0JBRTlELGlEQUFpRDtnQkFDakQsSUFBSVgsWUFBWSxJQUFJLENBQUNkLFVBQVUsRUFBRTtvQkFDL0I7Z0JBQ0Y7Z0JBRUEscURBQXFEO2dCQUNyRCxNQUFNOEIsUUFBUSxJQUFJLENBQUM3QixVQUFVLEdBQUc4QixLQUFLQyxHQUFHLENBQUMsR0FBR2xCLFVBQVU7Z0JBQ3RELE1BQU0sSUFBSW1CLFFBQVFDLENBQUFBLFVBQVdDLFdBQVdELFNBQVNKO1lBQ25EO1FBQ0Y7UUFFQSxNQUFNakIsYUFBYSxJQUFJVixNQUFNO0lBQy9CO0lBRUE7O0dBRUMsR0FDRCxNQUFNaUMsY0FBZ0M7UUFDcEMsSUFBSTtZQUNGLE1BQU1yQixXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ2pCLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDckRtQixTQUFTO29CQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQixLQUFLLENBQUMsQ0FBQztnQkFDekM7WUFDRjtZQUVBLE9BQU9hLFNBQVNLLEVBQUU7UUFDcEIsRUFBRSxPQUFNO1lBQ04sT0FBTztRQUNUO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvLi9zcmMvbGliL3NlcnZpY2VzL1Bob3RvUm9vbVNlcnZpY2UudHM/OTgzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQSE9UT1JPT01fVE9LRU4gfSBmcm9tICdAL2xpYi9jb25maWcnXG5cbmludGVyZmFjZSBQaG90b1Jvb21SZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgcmVzdWx0Pzoge1xuICAgIGltYWdlOiBzdHJpbmcgLy8gYmFzZTY0IGVuY29kZWQgaW1hZ2VcbiAgfVxuICBlcnJvcj86IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgUGhvdG9Sb29tU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgdG9rZW46IHN0cmluZ1xuICBwcml2YXRlIHJlYWRvbmx5IGJhc2VVcmwgPSAnaHR0cHM6Ly9pbWFnZS1hcGkucGhvdG9yb29tLmNvbS92Mi9lZGl0J1xuICBwcml2YXRlIHJlYWRvbmx5IG1heFJldHJpZXMgPSAzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmV0cnlEZWxheSA9IDEwMDAgLy8gMSBzZWNvbmRcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRva2VuID0gUEhPVE9ST09NX1RPS0VOXG4gICAgaWYgKCF0aGlzLnRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BIT1RPUk9PTV9UT0tFTiBpcyByZXF1aXJlZCcpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCj0LTQsNC70Y/QtdGCINGE0L7QvSDQuNC30L7QsdGA0LDQttC10L3QuNGPINGH0LXRgNC10LcgUGhvdG9Sb29tIEFQSVxuICAgKiBAcGFyYW0gaW1hZ2VCdWZmZXIgQnVmZmVyINGBINC40LfQvtCx0YDQsNC20LXQvdC40LXQvFxuICAgKiBAcmV0dXJucyBQcm9taXNlPEJ1ZmZlcj4g0YEg0L7QsdGA0LDQsdC+0YLQsNC90L3Ri9C8INC40LfQvtCx0YDQsNC20LXQvdC40LXQvFxuICAgKi9cbiAgYXN5bmMgcmVtb3ZlQmFja2dyb3VuZChpbWFnZUJ1ZmZlcjogQnVmZmVyKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgXG4gICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INC40LfQvtCx0YDQsNC20LXQvdC40LUg0LrQsNC6IGJpbmFyeSBkYXRhXG4gICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtuZXcgVWludDhBcnJheShpbWFnZUJ1ZmZlcildLCB7IHR5cGU6ICdpbWFnZS9qcGVnJyB9KVxuICAgIGZvcm1EYXRhLmFwcGVuZCgnaW1hZ2VGaWxlJywgYmxvYiwgJ2ltYWdlLmpwZycpXG4gICAgXG4gICAgLy8g0J/QsNGA0LDQvNC10YLRgNGLINC00LvRjyDRg9C00LDQu9C10L3QuNGPINGE0L7QvdCwINC4INC+0LHRgNCw0LHQvtGC0LrQuFxuICAgIGZvcm1EYXRhLmFwcGVuZCgnYmFja2dyb3VuZC5jb2xvcicsICdGRkZGRkYnKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgnb3V0cHV0U2l6ZScsICcyMDAweDIwMDAnKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgncG9zaXRpb24uZ3Jhdml0eScsICdjZW50ZXInKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgncGFkZGluZycsICcwLjE0JylcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ2V4cG9ydC5mb3JtYXQnLCAnanBnJylcblxuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGxcblxuICAgIC8vINCt0LrRgdC/0L7QvdC10L3RhtC40LDQu9GM0L3QsNGPINC30LDQtNC10YDQttC60LAg0YEg0YDQtdGC0YDQsNGP0LzQuFxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IHRoaXMubWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuYmFzZVVybCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBY2NlcHQnOiAnaW1hZ2UvcG5nLCBhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICd4LWFwaS1rZXknOiB0aGlzLnRva2VuLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCe0LHRgNCw0LHQvtGC0LrQsCDRgdC/0LXRhtC40YTQuNGH0L3Ri9GFINC+0YjQuNCx0L7QuiBQaG90b1Jvb21cbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVG9vIG1hbnkgcmVxdWVzdHMgdG8gUGhvdG9Sb29tIEFQSScpXG4gICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFBob3RvUm9vbSBBUEkgdG9rZW4nKVxuICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQaG90b1Jvb20gc2VydmVyIGVycm9yOiAke2Vycm9yRGF0YS5lcnJvciB8fCAnVW5rbm93biBlcnJvcid9YClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQaG90b1Jvb20gQVBJIGVycm9yOiAke2Vycm9yRGF0YS5lcnJvciB8fCAnVW5rbm93biBlcnJvcid9YClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQaG90b1Jvb20g0LLQvtC30LLRgNCw0YnQsNC10YIg0LjQt9C+0LHRgNCw0LbQtdC90LjQtSDQvdCw0L/RgNGP0LzRg9GOLCDQsCDQvdC1IEpTT05cbiAgICAgICAgY29uc3QgaW1hZ2VCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpXG4gICAgICAgIHJldHVybiBCdWZmZXIuZnJvbShpbWFnZUJ1ZmZlcilcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbGFzdEVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpXG4gICAgICAgIFxuICAgICAgICAvLyDQldGB0LvQuCDRjdGC0L4g0L/QvtGB0LvQtdC00L3Rj9GPINC/0L7Qv9GL0YLQutCwLCDQstGL0LHRgNCw0YHRi9Cy0LDQtdC8INC+0YjQuNCx0LrRg1xuICAgICAgICBpZiAoYXR0ZW1wdCA9PT0gdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vINCt0LrRgdC/0L7QvdC10L3RhtC40LDQu9GM0L3QsNGPINC30LDQtNC10YDQttC60LAg0L/QtdGA0LXQtCDRgdC70LXQtNGD0Y7RidC10Lkg0L/QvtC/0YvRgtC60L7QuVxuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMucmV0cnlEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQgLSAxKVxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKVxuICAgICAgfVxuICAgIH1cblxuICAgIHRocm93IGxhc3RFcnJvciB8fCBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZW1vdmUgYmFja2dyb3VuZCBhZnRlciByZXRyaWVzJylcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0L7QstC10YDRj9C10YIg0LTQvtGB0YLRg9C/0L3QvtGB0YLRjCBQaG90b1Jvb20gQVBJXG4gICAqL1xuICBhc3luYyBjaGVja0hlYWx0aCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2hlYWx0aGAsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMudG9rZW59YCxcbiAgICAgICAgfSxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiByZXNwb25zZS5va1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbIlBIT1RPUk9PTV9UT0tFTiIsIlBob3RvUm9vbVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheSIsInRva2VuIiwiRXJyb3IiLCJyZW1vdmVCYWNrZ3JvdW5kIiwiaW1hZ2VCdWZmZXIiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYmxvYiIsIkJsb2IiLCJVaW50OEFycmF5IiwidHlwZSIsImFwcGVuZCIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJvayIsImVycm9yRGF0YSIsImpzb24iLCJjYXRjaCIsInN0YXR1cyIsImVycm9yIiwiYXJyYXlCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiU3RyaW5nIiwiZGVsYXkiLCJNYXRoIiwicG93IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiY2hlY2tIZWFsdGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/PhotoRoomService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();