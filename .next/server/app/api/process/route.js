"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/process/route";
exports.ids = ["app/api/process/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   headerHooks: () => (/* binding */ headerHooks),\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage),\n/* harmony export */   staticGenerationBailout: () => (/* binding */ staticGenerationBailout)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_mak_Desktop_PhotoSku_src_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/process/route.ts */ \"(rsc)/./src/app/api/process/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/process/route\",\n        pathname: \"/api/process\",\n        filename: \"route\",\n        bundlePath: \"app/api/process/route\"\n    },\n    resolvedPagePath: \"/Users/mak/Desktop/PhotoSku/src/app/api/process/route.ts\",\n    nextConfigOutput,\n    userland: _Users_mak_Desktop_PhotoSku_src_app_api_process_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks, headerHooks, staticGenerationBailout } = routeModule;\nconst originalPathname = \"/api/process/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZwcm9jZXNzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGcHJvY2VzcyUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRm1hayUyRkRlc2t0b3AlMkZQaG90b1NrdSUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZtYWslMkZEZXNrdG9wJTJGUGhvdG9Ta3UmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDUTtBQUNyRjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLHVHQUF1RztBQUMvRztBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQzZKOztBQUU3SiIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvP2Y2OGEiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL2FwcC1yb3V0ZS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBwYXRjaEZldGNoIGFzIF9wYXRjaEZldGNoIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL3BhdGNoLWZldGNoXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL21hay9EZXNrdG9wL1Bob3RvU2t1L3NyYy9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3Byb2Nlc3Mvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9wcm9jZXNzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9wcm9jZXNzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL21hay9EZXNrdG9wL1Bob3RvU2t1L3NyYy9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgaGVhZGVySG9va3MsIHN0YXRpY0dlbmVyYXRpb25CYWlsb3V0IH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvcHJvY2Vzcy9yb3V0ZVwiO1xuZnVuY3Rpb24gcGF0Y2hGZXRjaCgpIHtcbiAgICByZXR1cm4gX3BhdGNoRmV0Y2goe1xuICAgICAgICBzZXJ2ZXJIb29rcyxcbiAgICAgICAgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZVxuICAgIH0pO1xufVxuZXhwb3J0IHsgcm91dGVNb2R1bGUsIHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBoZWFkZXJIb29rcywgc3RhdGljR2VuZXJhdGlvbkJhaWxvdXQsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/process/route.ts":
/*!**************************************!*\
  !*** ./src/app/api/process/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/web/exports/next-response */ \"(rsc)/./node_modules/next/dist/server/web/exports/next-response.js\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _lib_services_PhotoRoomService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/services/PhotoRoomService */ \"(rsc)/./src/lib/services/PhotoRoomService.ts\");\n\n\n\n\n// Ограничение на одновременные запросы к PhotoRoom\nconst MAX_CONCURRENT_REQUESTS = 3;\nlet activeRequests = 0;\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { sku, files } = body;\n        if (!sku || !files || files.length === 0) {\n            return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n                error: \"SKU and files are required\"\n            }, {\n                status: 400\n            });\n        }\n        const photoRoomService = new _lib_services_PhotoRoomService__WEBPACK_IMPORTED_MODULE_3__.PhotoRoomService();\n        const results = [];\n        // Фильтруем только изображения для обработки\n        const imageFiles = files.filter((file)=>file.type === \"image\");\n        const videoFiles = files.filter((file)=>file.type === \"video\");\n        // Считаем общее количество файлов для правильной нумерации\n        const totalFiles = imageFiles.length + videoFiles.length;\n        let fileCounter = 1;\n        // Сохраняем пути к оригинальным файлам для удаления после обработки\n        const originalFilesToDelete = [];\n        // Обрабатываем видео (просто пропускаем)\n        for (const videoFile of videoFiles){\n            const finalName = `${sku}_${String(fileCounter).padStart(3, \"0\")}.mp4`;\n            results.push({\n                id: videoFile.id,\n                originalName: videoFile.fileName,\n                finalName: finalName,\n                status: \"skipped\"\n            });\n            fileCounter++;\n        }\n        // Обрабатываем изображения с ограничением concurrent запросов\n        for(let i = 0; i < imageFiles.length; i += MAX_CONCURRENT_REQUESTS){\n            const batch = imageFiles.slice(i, i + MAX_CONCURRENT_REQUESTS);\n            // Ждем, если слишком много активных запросов\n            while(activeRequests >= MAX_CONCURRENT_REQUESTS){\n                await new Promise((resolve)=>setTimeout(resolve, 1000));\n            }\n            activeRequests++;\n            const batchPromises = batch.map(async (file)=>{\n                try {\n                    // Генерируем уникальное имя файла для этого конкретного файла\n                    const currentFileCounter = fileCounter++;\n                    // PhotoRoom всегда возвращает JPG формат\n                    const finalName = `${sku}_${String(currentFileCounter).padStart(3, \"0\")}.jpg`;\n                    // Читаем файл\n                    const filePath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.cwd(), \"temp\", sku, file.fileName);\n                    const fileBuffer = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.readFile)(filePath);\n                    // Удаляем фон через PhotoRoom\n                    const processedBuffer = await photoRoomService.removeBackground(fileBuffer);\n                    // Сохраняем обработанный файл\n                    const processedPath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.cwd(), \"temp\", sku, finalName);\n                    await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(processedPath, processedBuffer);\n                    // Принудительно синхронизируем файл с диском\n                    const fileHandle = await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.open)(processedPath, \"r+\");\n                    await fileHandle.sync();\n                    await fileHandle.close();\n                    console.log(`Processed file saved to: ${processedPath}`);\n                    // Добавляем оригинальный файл в список для удаления\n                    originalFilesToDelete.push(filePath);\n                    return {\n                        id: file.id,\n                        originalName: file.originalName,\n                        finalName: finalName,\n                        status: \"done\",\n                        processedPath\n                    };\n                } catch (error) {\n                    console.error(`Error processing file ${file.fileName}:`, error);\n                    // Генерируем уникальное имя файла для ошибки\n                    const currentFileCounter = fileCounter++;\n                    // В случае ошибки, оставляем оригинал и помечаем как ошибку\n                    const originalExtension = file.fileName.split(\".\").pop() || \"jpg\";\n                    const errorFinalName = `${sku}_${String(currentFileCounter).padStart(3, \"0\")}.${originalExtension}`;\n                    // В случае ошибки не удаляем оригинал\n                    return {\n                        id: file.id,\n                        originalName: file.originalName,\n                        finalName: errorFinalName,\n                        status: \"error\",\n                        error: error instanceof Error ? error.message : \"Unknown error\",\n                        processedPath: (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.cwd(), \"temp\", sku, file.fileName)\n                    };\n                }\n            });\n            const batchResults = await Promise.all(batchPromises);\n            results.push(...batchResults);\n            activeRequests--;\n        }\n        // Сохраняем информацию о процессинге в отдельный файл для использования при скачивании\n        const processInfoPath = (0,path__WEBPACK_IMPORTED_MODULE_2__.join)(process.cwd(), \"temp\", sku, \"process-info.json\");\n        await (0,fs_promises__WEBPACK_IMPORTED_MODULE_1__.writeFile)(processInfoPath, JSON.stringify(results, null, 2));\n        // Не удаляем оригинальные файлы - они могут быть полезны для отладки\n        // и занимают мало места по сравнению с обработанными файлами\n        console.log(\"Original files preserved for debugging:\", originalFilesToDelete);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            success: true,\n            results,\n            sku\n        });\n    } catch (error) {\n        console.error(\"Process error:\", error);\n        return next_dist_server_web_exports_next_response__WEBPACK_IMPORTED_MODULE_0__[\"default\"].json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O1FBQ3pELE1BQU1WLHNEQUFTQSxDQUFDOEQsaUJBQWlCQyxLQUFLQyxTQUFTLENBQUNoRCxTQUFTLE1BQU07UUFFL0QscUVBQXFFO1FBQ3JFLDZEQUE2RDtRQUM3RG9DLFFBQVFDLEdBQUcsQ0FBQywyQ0FBMkM3QjtRQUV2RCxPQUFPMUIsa0ZBQVlBLENBQUNXLElBQUksQ0FBQztZQUN2QndELFNBQVM7WUFDVGpEO1lBQ0FOO1FBQ0Y7SUFFRixFQUFFLE9BQU9HLE9BQU87UUFDZHVDLFFBQVF2QyxLQUFLLENBQUMsa0JBQWtCQTtRQUNoQyxPQUFPZixrRkFBWUEsQ0FBQ1csSUFBSSxDQUN0QjtZQUFFSSxPQUFPO1FBQXdCLEdBQ2pDO1lBQUVDLFFBQVE7UUFBSTtJQUVsQjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGhvdG8tc2t1LXByb2Nlc3Nvci8uL3NyYy9hcHAvYXBpL3Byb2Nlc3Mvcm91dGUudHM/NmFmMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyByZWFkRmlsZSwgdW5saW5rLCB3cml0ZUZpbGUsIG9wZW4gfSBmcm9tICdmcy9wcm9taXNlcydcbmltcG9ydCB7IGpvaW4gfSBmcm9tICdwYXRoJ1xuaW1wb3J0IHsgUGhvdG9Sb29tU2VydmljZSB9IGZyb20gJ0AvbGliL3NlcnZpY2VzL1Bob3RvUm9vbVNlcnZpY2UnXG5cbmludGVyZmFjZSBQcm9jZXNzUmVxdWVzdCB7XG4gIHNrdTogc3RyaW5nXG4gIGZpbGVzOiBBcnJheTx7XG4gICAgaWQ6IHN0cmluZ1xuICAgIGZpbGVOYW1lOiBzdHJpbmdcbiAgICBmaWxlUGF0aDogc3RyaW5nXG4gICAgdHlwZTogc3RyaW5nXG4gICAgb3JpZ2luYWxOYW1lOiBzdHJpbmdcbiAgfT5cbn1cblxuaW50ZXJmYWNlIFByb2Nlc3NSZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgcmVzdWx0czogQXJyYXk8e1xuICAgIGlkOiBzdHJpbmdcbiAgICBvcmlnaW5hbE5hbWU6IHN0cmluZ1xuICAgIGZpbmFsTmFtZTogc3RyaW5nXG4gICAgc3RhdHVzOiAnZG9uZScgfCAnZXJyb3InIHwgJ3NraXBwZWQnXG4gICAgZXJyb3I/OiBzdHJpbmdcbiAgICBwcm9jZXNzZWRQYXRoPzogc3RyaW5nXG4gIH0+XG59XG5cbi8vINCe0LPRgNCw0L3QuNGH0LXQvdC40LUg0L3QsCDQvtC00L3QvtCy0YDQtdC80LXQvdC90YvQtSDQt9Cw0L/RgNC+0YHRiyDQuiBQaG90b1Jvb21cbmNvbnN0IE1BWF9DT05DVVJSRU5UX1JFUVVFU1RTID0gM1xubGV0IGFjdGl2ZVJlcXVlc3RzID0gMFxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXF1ZXN0Lmpzb24oKSBhcyBQcm9jZXNzUmVxdWVzdFxuICAgIGNvbnN0IHsgc2t1LCBmaWxlcyB9ID0gYm9keVxuXG4gICAgaWYgKCFza3UgfHwgIWZpbGVzIHx8IGZpbGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IGVycm9yOiAnU0tVIGFuZCBmaWxlcyBhcmUgcmVxdWlyZWQnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKVxuICAgIH1cblxuICAgIGNvbnN0IHBob3RvUm9vbVNlcnZpY2UgPSBuZXcgUGhvdG9Sb29tU2VydmljZSgpXG4gICAgY29uc3QgcmVzdWx0czogUHJvY2Vzc1Jlc3BvbnNlWydyZXN1bHRzJ10gPSBbXVxuXG4gICAgLy8g0KTQuNC70YzRgtGA0YPQtdC8INGC0L7Qu9GM0LrQviDQuNC30L7QsdGA0LDQttC10L3QuNGPINC00LvRjyDQvtCx0YDQsNCx0L7RgtC60LhcbiAgICBjb25zdCBpbWFnZUZpbGVzID0gZmlsZXMuZmlsdGVyKGZpbGUgPT4gZmlsZS50eXBlID09PSAnaW1hZ2UnKVxuICAgIGNvbnN0IHZpZGVvRmlsZXMgPSBmaWxlcy5maWx0ZXIoZmlsZSA9PiBmaWxlLnR5cGUgPT09ICd2aWRlbycpXG5cbiAgICAvLyDQodGH0LjRgtCw0LXQvCDQvtCx0YnQtdC1INC60L7Qu9C40YfQtdGB0YLQstC+INGE0LDQudC70L7QsiDQtNC70Y8g0L/RgNCw0LLQuNC70YzQvdC+0Lkg0L3Rg9C80LXRgNCw0YbQuNC4XG4gICAgY29uc3QgdG90YWxGaWxlcyA9IGltYWdlRmlsZXMubGVuZ3RoICsgdmlkZW9GaWxlcy5sZW5ndGhcbiAgICBsZXQgZmlsZUNvdW50ZXIgPSAxXG4gICAgXG4gICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INC/0YPRgtC4INC6INC+0YDQuNCz0LjQvdCw0LvRjNC90YvQvCDRhNCw0LnQu9Cw0Lwg0LTQu9GPINGD0LTQsNC70LXQvdC40Y8g0L/QvtGB0LvQtSDQvtCx0YDQsNCx0L7RgtC60LhcbiAgICBjb25zdCBvcmlnaW5hbEZpbGVzVG9EZWxldGU6IHN0cmluZ1tdID0gW11cblxuICAgIC8vINCe0LHRgNCw0LHQsNGC0YvQstCw0LXQvCDQstC40LTQtdC+ICjQv9GA0L7RgdGC0L4g0L/RgNC+0L/Rg9GB0LrQsNC10LwpXG4gICAgZm9yIChjb25zdCB2aWRlb0ZpbGUgb2YgdmlkZW9GaWxlcykge1xuICAgICAgY29uc3QgZmluYWxOYW1lID0gYCR7c2t1fV8ke1N0cmluZyhmaWxlQ291bnRlcikucGFkU3RhcnQoMywgJzAnKX0ubXA0YFxuICAgICAgcmVzdWx0cy5wdXNoKHtcbiAgICAgICAgaWQ6IHZpZGVvRmlsZS5pZCxcbiAgICAgICAgb3JpZ2luYWxOYW1lOiB2aWRlb0ZpbGUuZmlsZU5hbWUsXG4gICAgICAgIGZpbmFsTmFtZTogZmluYWxOYW1lLFxuICAgICAgICBzdGF0dXM6ICdza2lwcGVkJ1xuICAgICAgfSlcbiAgICAgIGZpbGVDb3VudGVyKytcbiAgICB9XG5cbiAgICAvLyDQntCx0YDQsNCx0LDRgtGL0LLQsNC10Lwg0LjQt9C+0LHRgNCw0LbQtdC90LjRjyDRgSDQvtCz0YDQsNC90LjRh9C10L3QuNC10LwgY29uY3VycmVudCDQt9Cw0L/RgNC+0YHQvtCyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbWFnZUZpbGVzLmxlbmd0aDsgaSArPSBNQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUykge1xuICAgICAgY29uc3QgYmF0Y2ggPSBpbWFnZUZpbGVzLnNsaWNlKGksIGkgKyBNQVhfQ09OQ1VSUkVOVF9SRVFVRVNUUylcbiAgICAgIFxuICAgICAgLy8g0JbQtNC10LwsINC10YHQu9C4INGB0LvQuNGI0LrQvtC8INC80L3QvtCz0L4g0LDQutGC0LjQstC90YvRhSDQt9Cw0L/RgNC+0YHQvtCyXG4gICAgICB3aGlsZSAoYWN0aXZlUmVxdWVzdHMgPj0gTUFYX0NPTkNVUlJFTlRfUkVRVUVTVFMpIHtcbiAgICAgICAgYXdhaXQgbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKVxuICAgICAgfVxuXG4gICAgICBhY3RpdmVSZXF1ZXN0cysrXG5cbiAgICAgIGNvbnN0IGJhdGNoUHJvbWlzZXMgPSBiYXRjaC5tYXAoYXN5bmMgKGZpbGUpID0+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAvLyDQk9C10L3QtdGA0LjRgNGD0LXQvCDRg9C90LjQutCw0LvRjNC90L7QtSDQuNC80Y8g0YTQsNC50LvQsCDQtNC70Y8g0Y3RgtC+0LPQviDQutC+0L3QutGA0LXRgtC90L7Qs9C+INGE0LDQudC70LBcbiAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNvdW50ZXIgPSBmaWxlQ291bnRlcisrXG4gICAgICAgICAgXG4gICAgICAgICAgLy8gUGhvdG9Sb29tINCy0YHQtdCz0LTQsCDQstC+0LfQstGA0LDRidCw0LXRgiBKUEcg0YTQvtGA0LzQsNGCXG4gICAgICAgICAgY29uc3QgZmluYWxOYW1lID0gYCR7c2t1fV8ke1N0cmluZyhjdXJyZW50RmlsZUNvdW50ZXIpLnBhZFN0YXJ0KDMsICcwJyl9LmpwZ2BcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQp9C40YLQsNC10Lwg0YTQsNC50LtcbiAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGpvaW4ocHJvY2Vzcy5jd2QoKSwgJ3RlbXAnLCBza3UsIGZpbGUuZmlsZU5hbWUpXG4gICAgICAgICAgY29uc3QgZmlsZUJ1ZmZlciA9IGF3YWl0IHJlYWRGaWxlKGZpbGVQYXRoKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCj0LTQsNC70Y/QtdC8INGE0L7QvSDRh9C10YDQtdC3IFBob3RvUm9vbVxuICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZEJ1ZmZlciA9IGF3YWl0IHBob3RvUm9vbVNlcnZpY2UucmVtb3ZlQmFja2dyb3VuZChmaWxlQnVmZmVyKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCh0L7RhdGA0LDQvdGP0LXQvCDQvtCx0YDQsNCx0L7RgtCw0L3QvdGL0Lkg0YTQsNC50LtcbiAgICAgICAgICBjb25zdCBwcm9jZXNzZWRQYXRoID0gam9pbihwcm9jZXNzLmN3ZCgpLCAndGVtcCcsIHNrdSwgZmluYWxOYW1lKVxuICAgICAgICAgIGF3YWl0IHdyaXRlRmlsZShwcm9jZXNzZWRQYXRoLCBwcm9jZXNzZWRCdWZmZXIpXG4gICAgICAgICAgXG4gICAgICAgICAgLy8g0J/RgNC40L3Rg9C00LjRgtC10LvRjNC90L4g0YHQuNC90YXRgNC+0L3QuNC30LjRgNGD0LXQvCDRhNCw0LnQuyDRgSDQtNC40YHQutC+0LxcbiAgICAgICAgICBjb25zdCBmaWxlSGFuZGxlID0gYXdhaXQgb3Blbihwcm9jZXNzZWRQYXRoLCAncisnKVxuICAgICAgICAgIGF3YWl0IGZpbGVIYW5kbGUuc3luYygpXG4gICAgICAgICAgYXdhaXQgZmlsZUhhbmRsZS5jbG9zZSgpXG4gICAgICAgICAgXG4gICAgICAgICAgY29uc29sZS5sb2coYFByb2Nlc3NlZCBmaWxlIHNhdmVkIHRvOiAke3Byb2Nlc3NlZFBhdGh9YClcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0L7RgNC40LPQuNC90LDQu9GM0L3Ri9C5INGE0LDQudC7INCyINGB0L/QuNGB0L7QuiDQtNC70Y8g0YPQtNCw0LvQtdC90LjRj1xuICAgICAgICAgIG9yaWdpbmFsRmlsZXNUb0RlbGV0ZS5wdXNoKGZpbGVQYXRoKVxuICAgICAgICAgIFxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogZmlsZS5pZCxcbiAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogZmlsZS5vcmlnaW5hbE5hbWUsIC8vIDwtLSDQmNGB0L/QvtC70YzQt9GD0LXQvCDQvtGA0LjQs9C40L3QsNC70YzQvdC+0LUg0LjQvNGPINGE0LDQudC70LBcbiAgICAgICAgICAgIGZpbmFsTmFtZTogZmluYWxOYW1lLFxuICAgICAgICAgICAgc3RhdHVzOiAnZG9uZScgYXMgY29uc3QsXG4gICAgICAgICAgICBwcm9jZXNzZWRQYXRoXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIHByb2Nlc3NpbmcgZmlsZSAke2ZpbGUuZmlsZU5hbWV9OmAsIGVycm9yKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCT0LXQvdC10YDQuNGA0YPQtdC8INGD0L3QuNC60LDQu9GM0L3QvtC1INC40LzRjyDRhNCw0LnQu9CwINC00LvRjyDQvtGI0LjQsdC60LhcbiAgICAgICAgICBjb25zdCBjdXJyZW50RmlsZUNvdW50ZXIgPSBmaWxlQ291bnRlcisrXG4gICAgICAgICAgXG4gICAgICAgICAgLy8g0JIg0YHQu9GD0YfQsNC1INC+0YjQuNCx0LrQuCwg0L7RgdGC0LDQstC70Y/QtdC8INC+0YDQuNCz0LjQvdCw0Lsg0Lgg0L/QvtC80LXRh9Cw0LXQvCDQutCw0Log0L7RiNC40LHQutGDXG4gICAgICAgICAgY29uc3Qgb3JpZ2luYWxFeHRlbnNpb24gPSBmaWxlLmZpbGVOYW1lLnNwbGl0KCcuJykucG9wKCkgfHwgJ2pwZydcbiAgICAgICAgICBjb25zdCBlcnJvckZpbmFsTmFtZSA9IGAke3NrdX1fJHtTdHJpbmcoY3VycmVudEZpbGVDb3VudGVyKS5wYWRTdGFydCgzLCAnMCcpfS4ke29yaWdpbmFsRXh0ZW5zaW9ufWBcbiAgICAgICAgICBcbiAgICAgICAgICAvLyDQkiDRgdC70YPRh9Cw0LUg0L7RiNC40LHQutC4INC90LUg0YPQtNCw0LvRj9C10Lwg0L7RgNC40LPQuNC90LDQu1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogZmlsZS5pZCxcbiAgICAgICAgICAgIG9yaWdpbmFsTmFtZTogZmlsZS5vcmlnaW5hbE5hbWUsXG4gICAgICAgICAgICBmaW5hbE5hbWU6IGVycm9yRmluYWxOYW1lLFxuICAgICAgICAgICAgc3RhdHVzOiAnZXJyb3InIGFzIGNvbnN0LFxuICAgICAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgICAgICAgcHJvY2Vzc2VkUGF0aDogam9pbihwcm9jZXNzLmN3ZCgpLCAndGVtcCcsIHNrdSwgZmlsZS5maWxlTmFtZSlcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG5cbiAgICAgIGNvbnN0IGJhdGNoUmVzdWx0cyA9IGF3YWl0IFByb21pc2UuYWxsKGJhdGNoUHJvbWlzZXMpXG4gICAgICByZXN1bHRzLnB1c2goLi4uYmF0Y2hSZXN1bHRzKVxuICAgICAgXG4gICAgICBhY3RpdmVSZXF1ZXN0cy0tXG4gICAgfVxuXG4gICAgLy8g0KHQvtGF0YDQsNC90Y/QtdC8INC40L3RhNC+0YDQvNCw0YbQuNGOINC+INC/0YDQvtGG0LXRgdGB0LjQvdCz0LUg0LIg0L7RgtC00LXQu9GM0L3Ri9C5INGE0LDQudC7INC00LvRjyDQuNGB0L/QvtC70YzQt9C+0LLQsNC90LjRjyDQv9GA0Lgg0YHQutCw0YfQuNCy0LDQvdC40LhcbiAgICBjb25zdCBwcm9jZXNzSW5mb1BhdGggPSBqb2luKHByb2Nlc3MuY3dkKCksICd0ZW1wJywgc2t1LCAncHJvY2Vzcy1pbmZvLmpzb24nKVxuICAgIGF3YWl0IHdyaXRlRmlsZShwcm9jZXNzSW5mb1BhdGgsIEpTT04uc3RyaW5naWZ5KHJlc3VsdHMsIG51bGwsIDIpKVxuXG4gICAgLy8g0J3QtSDRg9C00LDQu9GP0LXQvCDQvtGA0LjQs9C40L3QsNC70YzQvdGL0LUg0YTQsNC50LvRiyAtINC+0L3QuCDQvNC+0LPRg9GCINCx0YvRgtGMINC/0L7Qu9C10LfQvdGLINC00LvRjyDQvtGC0LvQsNC00LrQuFxuICAgIC8vINC4INC30LDQvdC40LzQsNGO0YIg0LzQsNC70L4g0LzQtdGB0YLQsCDQv9C+INGB0YDQsNCy0L3QtdC90LjRjiDRgSDQvtCx0YDQsNCx0L7RgtCw0L3QvdGL0LzQuCDRhNCw0LnQu9Cw0LzQuFxuICAgIGNvbnNvbGUubG9nKCdPcmlnaW5hbCBmaWxlcyBwcmVzZXJ2ZWQgZm9yIGRlYnVnZ2luZzonLCBvcmlnaW5hbEZpbGVzVG9EZWxldGUpXG5cbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHJlc3VsdHMsXG4gICAgICBza3VcbiAgICB9KVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignUHJvY2VzcyBlcnJvcjonLCBlcnJvcilcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnSW50ZXJuYWwgc2VydmVyIGVycm9yJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKVxuICB9XG59Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsInJlYWRGaWxlIiwid3JpdGVGaWxlIiwib3BlbiIsImpvaW4iLCJQaG90b1Jvb21TZXJ2aWNlIiwiTUFYX0NPTkNVUlJFTlRfUkVRVUVTVFMiLCJhY3RpdmVSZXF1ZXN0cyIsIlBPU1QiLCJyZXF1ZXN0IiwiYm9keSIsImpzb24iLCJza3UiLCJmaWxlcyIsImxlbmd0aCIsImVycm9yIiwic3RhdHVzIiwicGhvdG9Sb29tU2VydmljZSIsInJlc3VsdHMiLCJpbWFnZUZpbGVzIiwiZmlsdGVyIiwiZmlsZSIsInR5cGUiLCJ2aWRlb0ZpbGVzIiwidG90YWxGaWxlcyIsImZpbGVDb3VudGVyIiwib3JpZ2luYWxGaWxlc1RvRGVsZXRlIiwidmlkZW9GaWxlIiwiZmluYWxOYW1lIiwiU3RyaW5nIiwicGFkU3RhcnQiLCJwdXNoIiwiaWQiLCJvcmlnaW5hbE5hbWUiLCJmaWxlTmFtZSIsImkiLCJiYXRjaCIsInNsaWNlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiYmF0Y2hQcm9taXNlcyIsIm1hcCIsImN1cnJlbnRGaWxlQ291bnRlciIsImZpbGVQYXRoIiwicHJvY2VzcyIsImN3ZCIsImZpbGVCdWZmZXIiLCJwcm9jZXNzZWRCdWZmZXIiLCJyZW1vdmVCYWNrZ3JvdW5kIiwicHJvY2Vzc2VkUGF0aCIsImZpbGVIYW5kbGUiLCJzeW5jIiwiY2xvc2UiLCJjb25zb2xlIiwibG9nIiwib3JpZ2luYWxFeHRlbnNpb24iLCJzcGxpdCIsInBvcCIsImVycm9yRmluYWxOYW1lIiwiRXJyb3IiLCJtZXNzYWdlIiwiYmF0Y2hSZXN1bHRzIiwiYWxsIiwicHJvY2Vzc0luZm9QYXRoIiwiSlNPTiIsInN0cmluZ2lmeSIsInN1Y2Nlc3MiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/process/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/config.ts":
/*!***************************!*\
  !*** ./src/lib/config.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ALLOWED_IMAGE_TYPES: () => (/* binding */ ALLOWED_IMAGE_TYPES),\n/* harmony export */   ALLOWED_VIDEO_TYPES: () => (/* binding */ ALLOWED_VIDEO_TYPES),\n/* harmony export */   MAX_CONCURRENT_PHOTOROOM_REQUESTS: () => (/* binding */ MAX_CONCURRENT_PHOTOROOM_REQUESTS),\n/* harmony export */   MAX_FILE_SIZE: () => (/* binding */ MAX_FILE_SIZE),\n/* harmony export */   PHOTOROOM_MAX_RETRIES: () => (/* binding */ PHOTOROOM_MAX_RETRIES),\n/* harmony export */   PHOTOROOM_RETRY_DELAY: () => (/* binding */ PHOTOROOM_RETRY_DELAY),\n/* harmony export */   PHOTOROOM_TOKEN: () => (/* binding */ PHOTOROOM_TOKEN),\n/* harmony export */   QUALITY_SETTINGS: () => (/* binding */ QUALITY_SETTINGS),\n/* harmony export */   SUPPORTED_FORMATS: () => (/* binding */ SUPPORTED_FORMATS)\n/* harmony export */ });\nconst PHOTOROOM_TOKEN = process.env.PHOTOROOM_TOKEN || \"\";\nconst MAX_FILE_SIZE = 25 * 1024 * 1024 // 25MB\n;\nconst ALLOWED_IMAGE_TYPES = [\n    \"image/jpeg\",\n    \"image/jpg\",\n    \"image/png\",\n    \"image/heic\"\n];\nconst ALLOWED_VIDEO_TYPES = [\n    \"video/mp4\",\n    \"video/quicktime\"\n];\nconst MAX_CONCURRENT_PHOTOROOM_REQUESTS = 3;\nconst PHOTOROOM_RETRY_DELAY = 1000 // 1 second\n;\nconst PHOTOROOM_MAX_RETRIES = 3;\nconst SUPPORTED_FORMATS = {\n    images: [\n        \"jpg\",\n        \"jpeg\",\n        \"png\",\n        \"heic\"\n    ],\n    videos: [\n        \"mp4\",\n        \"mov\"\n    ]\n};\nconst QUALITY_SETTINGS = {\n    image: 0.92,\n    zip: 6 // compression level for ZIP\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2NvbmZpZy50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBTyxNQUFNQSxrQkFBa0JDLFFBQVFDLEdBQUcsQ0FBQ0YsZUFBZSxJQUFJLEdBQUU7QUFFekQsTUFBTUcsZ0JBQWdCLEtBQUssT0FBTyxLQUFLLE9BQU87Q0FBUjtBQUN0QyxNQUFNQyxzQkFBc0I7SUFDakM7SUFDQTtJQUNBO0lBQ0E7Q0FDRDtBQUNNLE1BQU1DLHNCQUFzQjtJQUNqQztJQUNBO0NBQ0Q7QUFFTSxNQUFNQyxvQ0FBb0MsRUFBQztBQUMzQyxNQUFNQyx3QkFBd0IsS0FBSyxXQUFXO0NBQVo7QUFDbEMsTUFBTUMsd0JBQXdCLEVBQUM7QUFFL0IsTUFBTUMsb0JBQW9CO0lBQy9CQyxRQUFRO1FBQUM7UUFBTztRQUFRO1FBQU87S0FBTztJQUN0Q0MsUUFBUTtRQUFDO1FBQU87S0FBTTtBQUN4QixFQUFDO0FBRU0sTUFBTUMsbUJBQW1CO0lBQzlCQyxPQUFPO0lBQ1BDLEtBQUssRUFBRSw0QkFBNEI7QUFDckMsRUFBQyIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvLi9zcmMvbGliL2NvbmZpZy50cz9hM2VmIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCBQSE9UT1JPT01fVE9LRU4gPSBwcm9jZXNzLmVudi5QSE9UT1JPT01fVE9LRU4gfHwgJydcblxuZXhwb3J0IGNvbnN0IE1BWF9GSUxFX1NJWkUgPSAyNSAqIDEwMjQgKiAxMDI0IC8vIDI1TUJcbmV4cG9ydCBjb25zdCBBTExPV0VEX0lNQUdFX1RZUEVTID0gW1xuICAnaW1hZ2UvanBlZycsXG4gICdpbWFnZS9qcGcnLCBcbiAgJ2ltYWdlL3BuZycsXG4gICdpbWFnZS9oZWljJ1xuXVxuZXhwb3J0IGNvbnN0IEFMTE9XRURfVklERU9fVFlQRVMgPSBbXG4gICd2aWRlby9tcDQnLFxuICAndmlkZW8vcXVpY2t0aW1lJ1xuXVxuXG5leHBvcnQgY29uc3QgTUFYX0NPTkNVUlJFTlRfUEhPVE9ST09NX1JFUVVFU1RTID0gM1xuZXhwb3J0IGNvbnN0IFBIT1RPUk9PTV9SRVRSWV9ERUxBWSA9IDEwMDAgLy8gMSBzZWNvbmRcbmV4cG9ydCBjb25zdCBQSE9UT1JPT01fTUFYX1JFVFJJRVMgPSAzXG5cbmV4cG9ydCBjb25zdCBTVVBQT1JURURfRk9STUFUUyA9IHtcbiAgaW1hZ2VzOiBbJ2pwZycsICdqcGVnJywgJ3BuZycsICdoZWljJ10sXG4gIHZpZGVvczogWydtcDQnLCAnbW92J11cbn1cblxuZXhwb3J0IGNvbnN0IFFVQUxJVFlfU0VUVElOR1MgPSB7XG4gIGltYWdlOiAwLjkyLCAvLyA5MiUgcXVhbGl0eSBmb3IgY29udmVydGVkIGltYWdlc1xuICB6aXA6IDYgLy8gY29tcHJlc3Npb24gbGV2ZWwgZm9yIFpJUFxufSJdLCJuYW1lcyI6WyJQSE9UT1JPT01fVE9LRU4iLCJwcm9jZXNzIiwiZW52IiwiTUFYX0ZJTEVfU0laRSIsIkFMTE9XRURfSU1BR0VfVFlQRVMiLCJBTExPV0VEX1ZJREVPX1RZUEVTIiwiTUFYX0NPTkNVUlJFTlRfUEhPVE9ST09NX1JFUVVFU1RTIiwiUEhPVE9ST09NX1JFVFJZX0RFTEFZIiwiUEhPVE9ST09NX01BWF9SRVRSSUVTIiwiU1VQUE9SVEVEX0ZPUk1BVFMiLCJpbWFnZXMiLCJ2aWRlb3MiLCJRVUFMSVRZX1NFVFRJTkdTIiwiaW1hZ2UiLCJ6aXAiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/config.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/services/PhotoRoomService.ts":
/*!**********************************************!*\
  !*** ./src/lib/services/PhotoRoomService.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   PhotoRoomService: () => (/* binding */ PhotoRoomService)\n/* harmony export */ });\n/* harmony import */ var _lib_config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/config */ \"(rsc)/./src/lib/config.ts\");\n\nclass PhotoRoomService {\n    constructor(){\n        this.baseUrl = \"https://image-api.photoroom.com/v2/edit\";\n        this.maxRetries = 3;\n        this.retryDelay = 1000 // 1 second\n        ;\n        this.token = _lib_config__WEBPACK_IMPORTED_MODULE_0__.PHOTOROOM_TOKEN;\n        if (!this.token) {\n            throw new Error(\"PHOTOROOM_TOKEN is required\");\n        }\n    }\n    /**\n   * Удаляет фон изображения через PhotoRoom API\n   * @param imageBuffer Buffer с изображением\n   * @returns Promise<Buffer> с обработанным изображением\n   */ async removeBackground(imageBuffer) {\n        const formData = new FormData();\n        // Добавляем изображение как binary data\n        const blob = new Blob([\n            new Uint8Array(imageBuffer)\n        ], {\n            type: \"image/jpeg\"\n        });\n        formData.append(\"imageFile\", blob, \"image.jpg\");\n        // Параметры для удаления фона и обработки\n        formData.append(\"background.color\", \"FFFFFF\");\n        formData.append(\"outputSize\", \"2000x2000\");\n        formData.append(\"position.gravity\", \"center\");\n        formData.append(\"padding\", \"0.14\");\n        formData.append(\"export.format\", \"jpg\");\n        let lastError = null;\n        // Экспоненциальная задержка с ретраями\n        for(let attempt = 1; attempt <= this.maxRetries; attempt++){\n            try {\n                const response = await fetch(this.baseUrl, {\n                    method: \"POST\",\n                    headers: {\n                        \"Accept\": \"image/png, application/json\",\n                        \"x-api-key\": this.token\n                    },\n                    body: formData\n                });\n                if (!response.ok) {\n                    const errorData = await response.json().catch(()=>({}));\n                    // Обработка специфичных ошибок PhotoRoom\n                    if (response.status === 429) {\n                        throw new Error(\"Too many requests to PhotoRoom API\");\n                    } else if (response.status === 401) {\n                        throw new Error(\"Invalid PhotoRoom API token\");\n                    } else if (response.status >= 500) {\n                        throw new Error(`PhotoRoom server error: ${errorData.error || \"Unknown error\"}`);\n                    } else {\n                        throw new Error(`PhotoRoom API error: ${errorData.error || \"Unknown error\"}`);\n                    }\n                }\n                // PhotoRoom возвращает изображение напрямую, а не JSON\n                const imageBuffer = await response.arrayBuffer();\n                return Buffer.from(imageBuffer);\n            } catch (error) {\n                lastError = error instanceof Error ? error : new Error(String(error));\n                // Если это последняя попытка, выбрасываем ошибку\n                if (attempt === this.maxRetries) {\n                    break;\n                }\n                // Экспоненциальная задержка перед следующей попыткой\n                const delay = this.retryDelay * Math.pow(2, attempt - 1);\n                await new Promise((resolve)=>setTimeout(resolve, delay));\n            }\n        }\n        throw lastError || new Error(\"Failed to remove background after retries\");\n    }\n    /**\n   * Проверяет доступность PhotoRoom API\n   */ async checkHealth() {\n        try {\n            const response = await fetch(`${this.baseUrl}/health`, {\n                headers: {\n                    \"Authorization\": `Bearer ${this.token}`\n                }\n            });\n            return response.ok;\n        } catch  {\n            return false;\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3NlcnZpY2VzL1Bob3RvUm9vbVNlcnZpY2UudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBOEM7QUFVdkMsTUFBTUM7SUFNWEMsYUFBYzthQUpHQyxVQUFVO2FBQ1ZDLGFBQWE7YUFDYkMsYUFBYSxLQUFLLFdBQVc7O1FBRzVDLElBQUksQ0FBQ0MsS0FBSyxHQUFHTix3REFBZUE7UUFDNUIsSUFBSSxDQUFDLElBQUksQ0FBQ00sS0FBSyxFQUFFO1lBQ2YsTUFBTSxJQUFJQyxNQUFNO1FBQ2xCO0lBQ0Y7SUFFQTs7OztHQUlDLEdBQ0QsTUFBTUMsaUJBQWlCQyxXQUFtQixFQUFtQjtRQUMzRCxNQUFNQyxXQUFXLElBQUlDO1FBRXJCLHdDQUF3QztRQUN4QyxNQUFNQyxPQUFPLElBQUlDLEtBQUs7WUFBQyxJQUFJQyxXQUFXTDtTQUFhLEVBQUU7WUFBRU0sTUFBTTtRQUFhO1FBQzFFTCxTQUFTTSxNQUFNLENBQUMsYUFBYUosTUFBTTtRQUVuQywwQ0FBMEM7UUFDMUNGLFNBQVNNLE1BQU0sQ0FBQyxvQkFBb0I7UUFDcENOLFNBQVNNLE1BQU0sQ0FBQyxjQUFjO1FBQzlCTixTQUFTTSxNQUFNLENBQUMsb0JBQW9CO1FBQ3BDTixTQUFTTSxNQUFNLENBQUMsV0FBVztRQUMzQk4sU0FBU00sTUFBTSxDQUFDLGlCQUFpQjtRQUVqQyxJQUFJQyxZQUEwQjtRQUU5Qix1Q0FBdUM7UUFDdkMsSUFBSyxJQUFJQyxVQUFVLEdBQUdBLFdBQVcsSUFBSSxDQUFDZCxVQUFVLEVBQUVjLFVBQVc7WUFDM0QsSUFBSTtnQkFDRixNQUFNQyxXQUFXLE1BQU1DLE1BQU0sSUFBSSxDQUFDakIsT0FBTyxFQUFFO29CQUN6Q2tCLFFBQVE7b0JBQ1JDLFNBQVM7d0JBQ1AsVUFBVTt3QkFDVixhQUFhLElBQUksQ0FBQ2hCLEtBQUs7b0JBQ3pCO29CQUNBaUIsTUFBTWI7Z0JBQ1I7Z0JBRUEsSUFBSSxDQUFDUyxTQUFTSyxFQUFFLEVBQUU7b0JBQ2hCLE1BQU1DLFlBQVksTUFBTU4sU0FBU08sSUFBSSxHQUFHQyxLQUFLLENBQUMsSUFBTyxFQUFDO29CQUV0RCx5Q0FBeUM7b0JBQ3pDLElBQUlSLFNBQVNTLE1BQU0sS0FBSyxLQUFLO3dCQUMzQixNQUFNLElBQUlyQixNQUFNO29CQUNsQixPQUFPLElBQUlZLFNBQVNTLE1BQU0sS0FBSyxLQUFLO3dCQUNsQyxNQUFNLElBQUlyQixNQUFNO29CQUNsQixPQUFPLElBQUlZLFNBQVNTLE1BQU0sSUFBSSxLQUFLO3dCQUNqQyxNQUFNLElBQUlyQixNQUFNLENBQUMsd0JBQXdCLEVBQUVrQixVQUFVSSxLQUFLLElBQUksZ0JBQWdCLENBQUM7b0JBQ2pGLE9BQU87d0JBQ0wsTUFBTSxJQUFJdEIsTUFBTSxDQUFDLHFCQUFxQixFQUFFa0IsVUFBVUksS0FBSyxJQUFJLGdCQUFnQixDQUFDO29CQUM5RTtnQkFDRjtnQkFFQSx1REFBdUQ7Z0JBQ3ZELE1BQU1wQixjQUFjLE1BQU1VLFNBQVNXLFdBQVc7Z0JBQzlDLE9BQU9DLE9BQU9DLElBQUksQ0FBQ3ZCO1lBRXJCLEVBQUUsT0FBT29CLE9BQU87Z0JBQ2RaLFlBQVlZLGlCQUFpQnRCLFFBQVFzQixRQUFRLElBQUl0QixNQUFNMEIsT0FBT0o7Z0JBRTlELGlEQUFpRDtnQkFDakQsSUFBSVgsWUFBWSxJQUFJLENBQUNkLFVBQVUsRUFBRTtvQkFDL0I7Z0JBQ0Y7Z0JBRUEscURBQXFEO2dCQUNyRCxNQUFNOEIsUUFBUSxJQUFJLENBQUM3QixVQUFVLEdBQUc4QixLQUFLQyxHQUFHLENBQUMsR0FBR2xCLFVBQVU7Z0JBQ3RELE1BQU0sSUFBSW1CLFFBQVFDLENBQUFBLFVBQVdDLFdBQVdELFNBQVNKO1lBQ25EO1FBQ0Y7UUFFQSxNQUFNakIsYUFBYSxJQUFJVixNQUFNO0lBQy9CO0lBRUE7O0dBRUMsR0FDRCxNQUFNaUMsY0FBZ0M7UUFDcEMsSUFBSTtZQUNGLE1BQU1yQixXQUFXLE1BQU1DLE1BQU0sQ0FBQyxFQUFFLElBQUksQ0FBQ2pCLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtnQkFDckRtQixTQUFTO29CQUNQLGlCQUFpQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUNoQixLQUFLLENBQUMsQ0FBQztnQkFDekM7WUFDRjtZQUVBLE9BQU9hLFNBQVNLLEVBQUU7UUFDcEIsRUFBRSxPQUFNO1lBQ04sT0FBTztRQUNUO0lBQ0Y7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3Bob3RvLXNrdS1wcm9jZXNzb3IvLi9zcmMvbGliL3NlcnZpY2VzL1Bob3RvUm9vbVNlcnZpY2UudHM/OTgzYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQSE9UT1JPT01fVE9LRU4gfSBmcm9tICdAL2xpYi9jb25maWcnXG5cbmludGVyZmFjZSBQaG90b1Jvb21SZXNwb25zZSB7XG4gIHN1Y2Nlc3M6IGJvb2xlYW5cbiAgcmVzdWx0Pzoge1xuICAgIGltYWdlOiBzdHJpbmcgLy8gYmFzZTY0IGVuY29kZWQgaW1hZ2VcbiAgfVxuICBlcnJvcj86IHN0cmluZ1xufVxuXG5leHBvcnQgY2xhc3MgUGhvdG9Sb29tU2VydmljZSB7XG4gIHByaXZhdGUgcmVhZG9ubHkgdG9rZW46IHN0cmluZ1xuICBwcml2YXRlIHJlYWRvbmx5IGJhc2VVcmwgPSAnaHR0cHM6Ly9pbWFnZS1hcGkucGhvdG9yb29tLmNvbS92Mi9lZGl0J1xuICBwcml2YXRlIHJlYWRvbmx5IG1heFJldHJpZXMgPSAzXG4gIHByaXZhdGUgcmVhZG9ubHkgcmV0cnlEZWxheSA9IDEwMDAgLy8gMSBzZWNvbmRcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLnRva2VuID0gUEhPVE9ST09NX1RPS0VOXG4gICAgaWYgKCF0aGlzLnRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1BIT1RPUk9PTV9UT0tFTiBpcyByZXF1aXJlZCcpXG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqINCj0LTQsNC70Y/QtdGCINGE0L7QvSDQuNC30L7QsdGA0LDQttC10L3QuNGPINGH0LXRgNC10LcgUGhvdG9Sb29tIEFQSVxuICAgKiBAcGFyYW0gaW1hZ2VCdWZmZXIgQnVmZmVyINGBINC40LfQvtCx0YDQsNC20LXQvdC40LXQvFxuICAgKiBAcmV0dXJucyBQcm9taXNlPEJ1ZmZlcj4g0YEg0L7QsdGA0LDQsdC+0YLQsNC90L3Ri9C8INC40LfQvtCx0YDQsNC20LXQvdC40LXQvFxuICAgKi9cbiAgYXN5bmMgcmVtb3ZlQmFja2dyb3VuZChpbWFnZUJ1ZmZlcjogQnVmZmVyKTogUHJvbWlzZTxCdWZmZXI+IHtcbiAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgXG4gICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INC40LfQvtCx0YDQsNC20LXQvdC40LUg0LrQsNC6IGJpbmFyeSBkYXRhXG4gICAgY29uc3QgYmxvYiA9IG5ldyBCbG9iKFtuZXcgVWludDhBcnJheShpbWFnZUJ1ZmZlcildLCB7IHR5cGU6ICdpbWFnZS9qcGVnJyB9KVxuICAgIGZvcm1EYXRhLmFwcGVuZCgnaW1hZ2VGaWxlJywgYmxvYiwgJ2ltYWdlLmpwZycpXG4gICAgXG4gICAgLy8g0J/QsNGA0LDQvNC10YLRgNGLINC00LvRjyDRg9C00LDQu9C10L3QuNGPINGE0L7QvdCwINC4INC+0LHRgNCw0LHQvtGC0LrQuFxuICAgIGZvcm1EYXRhLmFwcGVuZCgnYmFja2dyb3VuZC5jb2xvcicsICdGRkZGRkYnKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgnb3V0cHV0U2l6ZScsICcyMDAweDIwMDAnKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgncG9zaXRpb24uZ3Jhdml0eScsICdjZW50ZXInKVxuICAgIGZvcm1EYXRhLmFwcGVuZCgncGFkZGluZycsICcwLjE0JylcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ2V4cG9ydC5mb3JtYXQnLCAnanBnJylcblxuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGxcblxuICAgIC8vINCt0LrRgdC/0L7QvdC10L3RhtC40LDQu9GM0L3QsNGPINC30LDQtNC10YDQttC60LAg0YEg0YDQtdGC0YDQsNGP0LzQuFxuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IHRoaXMubWF4UmV0cmllczsgYXR0ZW1wdCsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHRoaXMuYmFzZVVybCwge1xuICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICdBY2NlcHQnOiAnaW1hZ2UvcG5nLCBhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICd4LWFwaS1rZXknOiB0aGlzLnRva2VuLFxuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogZm9ybURhdGEsXG4gICAgICAgIH0pXG5cbiAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKS5jYXRjaCgoKSA9PiAoe30pKVxuICAgICAgICAgIFxuICAgICAgICAgIC8vINCe0LHRgNCw0LHQvtGC0LrQsCDRgdC/0LXRhtC40YTQuNGH0L3Ri9GFINC+0YjQuNCx0L7QuiBQaG90b1Jvb21cbiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MjkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVG9vIG1hbnkgcmVxdWVzdHMgdG8gUGhvdG9Sb29tIEFQSScpXG4gICAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIFBob3RvUm9vbSBBUEkgdG9rZW4nKVxuICAgICAgICAgIH0gZWxzZSBpZiAocmVzcG9uc2Uuc3RhdHVzID49IDUwMCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQaG90b1Jvb20gc2VydmVyIGVycm9yOiAke2Vycm9yRGF0YS5lcnJvciB8fCAnVW5rbm93biBlcnJvcid9YClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQaG90b1Jvb20gQVBJIGVycm9yOiAke2Vycm9yRGF0YS5lcnJvciB8fCAnVW5rbm93biBlcnJvcid9YClcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBQaG90b1Jvb20g0LLQvtC30LLRgNCw0YnQsNC10YIg0LjQt9C+0LHRgNCw0LbQtdC90LjQtSDQvdCw0L/RgNGP0LzRg9GOLCDQsCDQvdC1IEpTT05cbiAgICAgICAgY29uc3QgaW1hZ2VCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpXG4gICAgICAgIHJldHVybiBCdWZmZXIuZnJvbShpbWFnZUJ1ZmZlcilcblxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbGFzdEVycm9yID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpXG4gICAgICAgIFxuICAgICAgICAvLyDQldGB0LvQuCDRjdGC0L4g0L/QvtGB0LvQtdC00L3Rj9GPINC/0L7Qv9GL0YLQutCwLCDQstGL0LHRgNCw0YHRi9Cy0LDQtdC8INC+0YjQuNCx0LrRg1xuICAgICAgICBpZiAoYXR0ZW1wdCA9PT0gdGhpcy5tYXhSZXRyaWVzKSB7XG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vINCt0LrRgdC/0L7QvdC10L3RhtC40LDQu9GM0L3QsNGPINC30LDQtNC10YDQttC60LAg0L/QtdGA0LXQtCDRgdC70LXQtNGD0Y7RidC10Lkg0L/QvtC/0YvRgtC60L7QuVxuICAgICAgICBjb25zdCBkZWxheSA9IHRoaXMucmV0cnlEZWxheSAqIE1hdGgucG93KDIsIGF0dGVtcHQgLSAxKVxuICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgZGVsYXkpKVxuICAgICAgfVxuICAgIH1cblxuICAgIHRocm93IGxhc3RFcnJvciB8fCBuZXcgRXJyb3IoJ0ZhaWxlZCB0byByZW1vdmUgYmFja2dyb3VuZCBhZnRlciByZXRyaWVzJylcbiAgfVxuXG4gIC8qKlxuICAgKiDQn9GA0L7QstC10YDRj9C10YIg0LTQvtGB0YLRg9C/0L3QvtGB0YLRjCBQaG90b1Jvb20gQVBJXG4gICAqL1xuICBhc3luYyBjaGVja0hlYWx0aCgpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2hlYWx0aGAsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMudG9rZW59YCxcbiAgICAgICAgfSxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiByZXNwb25zZS5va1xuICAgIH0gY2F0Y2gge1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG59Il0sIm5hbWVzIjpbIlBIT1RPUk9PTV9UT0tFTiIsIlBob3RvUm9vbVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImJhc2VVcmwiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheSIsInRva2VuIiwiRXJyb3IiLCJyZW1vdmVCYWNrZ3JvdW5kIiwiaW1hZ2VCdWZmZXIiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiYmxvYiIsIkJsb2IiLCJVaW50OEFycmF5IiwidHlwZSIsImFwcGVuZCIsImxhc3RFcnJvciIsImF0dGVtcHQiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImJvZHkiLCJvayIsImVycm9yRGF0YSIsImpzb24iLCJjYXRjaCIsInN0YXR1cyIsImVycm9yIiwiYXJyYXlCdWZmZXIiLCJCdWZmZXIiLCJmcm9tIiwiU3RyaW5nIiwiZGVsYXkiLCJNYXRoIiwicG93IiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiY2hlY2tIZWFsdGgiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/services/PhotoRoomService.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fprocess%2Froute&page=%2Fapi%2Fprocess%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fprocess%2Froute.ts&appDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fmak%2FDesktop%2FPhotoSku&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();