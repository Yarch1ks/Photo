"use strict";(()=>{var e={};e.id=990,e.ids=[990],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3292:e=>{e.exports=require("fs/promises")},1017:e=>{e.exports=require("path")},476:(e,r,o)=>{o.r(r),o.d(r,{headerHooks:()=>g,originalPathname:()=>P,patchFetch:()=>k,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>f,staticGenerationAsyncStorage:()=>h,staticGenerationBailout:()=>m});var t={};o.r(t),o.d(t,{POST:()=>p});var s=o(5419),a=o(9108),n=o(9678),i=o(8070),l=o(3292),u=o(1017);async function p(e){try{let{sku:r}=await e.json();if(!r)return i.Z.json({error:"SKU is required"},{status:400});let o=process.env.RAILWAY_SERVICE_NAME?"/tmp/uploads":"./uploads",t=(0,u.join)(o,r),s=(0,u.join)(t,`${r}-process-info.json`),{processedFiles:a}=JSON.parse(await (0,l.readFile)(s,"utf-8"));for(let e of a)try{await (0,l.unlink)(e.originalPath),console.log(`Deleted original file: ${e.originalPath}`),await (0,l.unlink)(e.processedPath),console.log(`Deleted processed file: ${e.processedPath}`)}catch(e){console.error(`Error deleting file: ${e}`)}try{await (0,l.unlink)(s),console.log(`Deleted process info: ${s}`)}catch(e){console.error(`Error deleting process info: ${e}`)}return i.Z.json({success:!0,message:"Files cleaned up successfully"})}catch(e){return console.error("Cleanup error:",e),i.Z.json({error:"Internal server error"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/cleanup/route",pathname:"/api/cleanup",filename:"route",bundlePath:"app/api/cleanup/route"},resolvedPagePath:"/Users/mak/Desktop/PhotoSku/src/app/api/cleanup/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:f,headerHooks:g,staticGenerationBailout:m}=c,P="/api/cleanup/route";function k(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:h})}}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[638,206],()=>o(476));module.exports=t})();